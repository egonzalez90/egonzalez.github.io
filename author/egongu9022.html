<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OpenStack Stuff | Articles by egongu90</title>
    <link rel="shortcut icon" type="image/png" href="https://egonzalez90.github.io/favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="https://egonzalez90.github.io/favicon.ico">
    <link href="https://egonzalez90.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="OpenStack Stuff Full Atom Feed" />
    <link rel="stylesheet" href="https://egonzalez90.github.io/theme/css/screen.css" type="text/css" />
    <link rel="stylesheet" href="https://egonzalez90.github.io/theme/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="https://egonzalez90.github.io/theme/css/print.css" type="text/css" media="print" />
    <meta name="generator" content="Pelican" />
    <meta name="description" content="" />
    <meta name="author" content="Eduardo Gonzalez" />
</head>
<body>
    <header>
        <nav>
            <ul>

                <li class="ephemeral selected"><a href="https://egonzalez90.github.io/author/egongu9022.html">egongu90</a></li>
                <li><a href="https://egonzalez90.github.io/">Home</a></li>
                <li><a href="https://docs.openstack.org">OpenStack</a></li>
                <li><a href="https://www.linkedin.com/in/eduardogonzalezgutierrez">Linkedin</a></li>
                <li><a href="https://github.com/egonzalez90">Github</a></li>
                <li><a href="https://egonzalez90.github.io/archives">Archives</a></li>
            </ul>
        </nav>
        <div class="header_box">
            <h1><a href="https://egonzalez90.github.io/">OpenStack Stuff</a></h1>
        </div>
    </header>
    <div id="wrapper">
        <div id="content">            <h4 class="date">Sep 07, 2014</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://egonzalez90.github.io/reiniciar-quota-count-incorrecto-openstack.html" rel="bookmark" title="Permanent Link to &quot;Reiniciar quota count incorrecto Openstack&quot;">Reiniciar quota count incorrecto Openstack</a>
                </h2>

                
                

                <p>Para reiniciar quota count, deberemos conectarnos a la base de datos y
establecer in_use en "-1"</p>
<blockquote>
<p>mysql -u nova -p\&lt;password> nova</p>
<p>select*from quota_usages;</p>
<p>update quota_usages set in_use='-1'where project_id='\&lt;my project
id>';</p>
</blockquote>
<p>A partir de la versión Icehouse, ya no se usa -1 y se pasa a usar 0</p>
<blockquote>
<p>update quota_usages set in_use='0'where project_id='\&lt;my project
id>';</p>
</blockquote>
                <div class="clear"></div>

                <div class="info">
                    <a href="https://egonzalez90.github.io/reiniciar-quota-count-incorrecto-openstack.html">posted at 15:50</a>
                    &nbsp;&middot;&nbsp;<a href="https://egonzalez90.github.io/category/openstack.html" rel="tag">OpenStack</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://egonzalez90.github.io/tag/bbdd.html" class="tags">bbdd</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/cloud.html" class="tags">cloud</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/count.html" class="tags">count</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/cuenta.html" class="tags">cuenta</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/cuota.html" class="tags">cuota</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/error.html" class="tags">error</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/id.html" class="tags">ID</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/incorrecto.html" class="tags">incorrecto</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/nova.html" class="tags">nova</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/openstack.html" class="tags">openstack</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/quota.html" class="tags">quota</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/reinicio.html" class="tags">reinicio</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/reset.html" class="tags">reset</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/tenant.html" class="tags">tenant</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/usage.html" class="tags">usage</a>
                </div>
		<a href="https://egonzalez90.github.io/reiniciar-quota-count-incorrecto-openstack.html#disqus_thread">Click to read and post comments</a>
            </article>            <h4 class="date">Sep 05, 2014</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://egonzalez90.github.io/montar-directorio-nfs.html" rel="bookmark" title="Permanent Link to &quot;Montar directorio NFS&quot;">Montar directorio NFS</a>
                </h2>

                
                

                <p>Primero crearemos la carpeta en donde vamos a montar el directorio NFS</p>
<blockquote>
<p>mkdir /rutadondemontareldirectorio</p>
</blockquote>
<p>A continuación utilizaremos este comando para montar el directorio NFS
en la carpeta creada anteriormente.</p>
<p>SERVIDOR puede ser tanto hostname como IP(yo siempre prefiero utilizar
IP)</p>
<blockquote>
<p>mount SERVIDOR:/ruta/a/la/carpeta /rutadondemontareldirectorio</p>
</blockquote>
<p>Una vez montado sin darnos ningún error, utilizaremos este comando para
comprobar que nos mostrara los directorios que están montados en nuestro
sistema y que tamaño tienen</p>
<blockquote>
<p>df -h</p>
</blockquote>
<p>Ahora que ya hemos montado el directorio NFS, lo incluiremos en fstab
para que se monte siempre en el arranque del sistema sin tener que
hacerlo manualmente por los pasos anteriores, para ello modificaremos
este archivo</p>
<blockquote>
<p>vi /etc/fstab</p>
</blockquote>
<p>Dentro del archivo incluiremos esta linea y guardaremos</p>
<blockquote>
<p>SERVIDOR:/ruta/a/la/carpeta            /rutadondemontareldirectorio  
         default            0 0</p>
</blockquote>
<p>Podemos comprobar que el archivo fstab funciona correctamente utilizando
el mismo comando de antes para ver los directorios montados y su tamaño,
pero esta vez lo haremos una vez encendida la maquina, sin haber montado
el directorio NFS de forma manual</p>
<blockquote>
<p>df -h</p>
</blockquote>
                <div class="clear"></div>

                <div class="info">
                    <a href="https://egonzalez90.github.io/montar-directorio-nfs.html">posted at 15:46</a>
                    &nbsp;&middot;&nbsp;<a href="https://egonzalez90.github.io/category/linux.html" rel="tag">Linux</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://egonzalez90.github.io/tag/centos.html" class="tags">centos</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/default.html" class="tags">default</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/df-h.html" class="tags">df -h</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/directorio.html" class="tags">directorio</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/fstab.html" class="tags">fstab</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/linux.html" class="tags">linux</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/montar.html" class="tags">montar</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/mount.html" class="tags">mount</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/nfs.html" class="tags">nfs</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/red-hat.html" class="tags">red hat</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/rhel.html" class="tags">rhel</a>
                </div>
		<a href="https://egonzalez90.github.io/montar-directorio-nfs.html#disqus_thread">Click to read and post comments</a>
            </article>            <h4 class="date">Sep 03, 2014</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://egonzalez90.github.io/alineamiento-mbr-maquinas-virtuales.html" rel="bookmark" title="Permanent Link to &quot;Alineamiento MBR maquinas virtuales&quot;">Alineamiento MBR maquinas virtuales</a>
                </h2>

                
                

                <p>Antes de la llegada de el sistema de ficheros EXT4, cuando creabas
maquinas virtuales, estas estaban desalineadas el mbr del vmfs y de el
almacenamiento,  lo que generaba menor rendimiento.<!--more--></p>
<p>Para ello dedico esta entrada, con la que mostrare como alinear el mbr.</p>
<p>Lo primero que necesitaremos es el paquete con las tools mbrscan y
mbralign, este paquete le copiaremos a el directorio /opt/ontap/ de un
host ESXi que tenga acceso al almacenamiento donde tenemos la maquina
guardada.</p>
<p>Una vez copiado el paquete a dicho directorio pasaremos a escanear y a
realinear el mbr de la maquina, para ello necesitamos que este apagada.</p>
<p>Una vez apagada iremos al directorio /opt/ontap/ y ejecutaremos el
siguiente comando con el que analizaremos el disco de la maquina para
ver si necesita ser alineado.</p>
<blockquote>
<p>./mbrscan
/vmfs/volumes/ALMACENAMIENTO/maquinavirtual/maquinavirtual-flat.vmdk</p>
</blockquote>
<p>Esto nos mostrara un mensaje en el que pondra:</p>
<blockquote>
<p>Aligned yes o Aligned no</p>
</blockquote>
<p>En el caso de que pusiera align no, deberemos realinear el mbr de la
maquina, lo haremos mediante este comando:</p>
<blockquote>
<p>./mbralign
/vmfs/volumes/ALMACENAMIENTO/maquinavirtual/maquinavirtual-flat.vmdk</p>
</blockquote>
<p>Esto nos creara un archivo .bak del disco que vamos a alinear por si
fallara este proceso poder recuperarlo, este proceso tardara
bastante(dependiendo del tamaño del disco)</p>
<p>Una vez acabado ese proceso de alineamiento, volveremos a utilizar el
comando mbrscan para comprobar que este bien hecho.</p>
<p>Por ultimo, el alineado del mbr se carga totalmente el GRUB de la
maquina, por lo que deberemos recuperarlo.</p>
<p>En esta entrada tienes como hacerlo: <a href="http://egonzalez.org/recuperar-grub-rhel-y-centos/%20" title="Recuperar GRUB RHEL y CentOS"><span id="sample-permalink"
style="color: #666666;" tabindex="-1">http://egonzalez.org/<span
id="editable-post-name"
title="Enlace permanente temporal. Haz clic para editar esta parte.">recuperar-grub-rhel-y-centos</span>/</span><span
style="color: #666666;"> </span></a></p>
<p>Una vez recuperado el GRUB y comprobado que la maquina funciona
correctamente, borraremos el archivo .bak que se había creado.</p>
<p>Espero poder ayudar, un saludo</p>
                <div class="clear"></div>

                <div class="info">
                    <a href="https://egonzalez90.github.io/alineamiento-mbr-maquinas-virtuales.html">posted at 15:21</a>
                    &nbsp;&middot;&nbsp;<a href="https://egonzalez90.github.io/category/linux-virtualizacion.html" rel="tag">Linux, Virtualizacion</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://egonzalez90.github.io/tag/alinear.html" class="tags">alinear</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/esxi.html" class="tags">esxi</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/ext3.html" class="tags">ext3</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/ext4.html" class="tags">ext4</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/grub.html" class="tags">grub</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/maquina-virtual.html" class="tags">maquina virtual</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/mbr.html" class="tags">mbr</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/mbralign.html" class="tags">mbralign</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/mbrscan.html" class="tags">mbrscan</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/netapp.html" class="tags">netapp</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/redhat.html" class="tags">redhat</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/rhel.html" class="tags">rhel</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/vm.html" class="tags">VM</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/vmfs.html" class="tags">vmfs</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/vmware.html" class="tags">vmware</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/volumes.html" class="tags">volumes</a>
                </div>
		<a href="https://egonzalez90.github.io/alineamiento-mbr-maquinas-virtuales.html#disqus_thread">Click to read and post comments</a>
            </article>

                <div class="clear"></div>
                <div class="pages">

                    <a href="https://egonzalez90.github.io/page/21" class="prev_page">&larr;&nbsp;Previous</a>
                    <a href="https://egonzalez90.github.io/page/23" class="next_page">Next&nbsp;&rarr;</a>
                    <span>Page 22 of 32</span>
                </div>

            <div class="clear"></div>
            <footer>
                <p>
                <a href="https://github.com/jody-frankowski/blue-penguin">Blue Penguin</a> Theme
                &middot;
                Powered by <a href="http://getpelican.com">Pelican</a>
                &middot;
                <a href="https://egonzalez90.github.io/feeds/all.atom.xml" rel="alternate">Atom Feed</a>
            </footer>
        </div>
        <div class="clear"></div>
    </div>
</body>
</html>