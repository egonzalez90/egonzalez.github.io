---
layout: post
title: Legacy Network
date: 2015-02-10 13:11:11.000000000 +01:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- OpenStack
tags:
- configurar
- crear
- icehouse
- legacy
- network
- network-create
- nova
- openstack
- red
meta:
  _edit_last: '2'
  _publicize_twitter_user: "@egongu90"
  _wpas_done_all: '1'
  _wpas_mess: Legacy Network
  _wpas_skip_10228321: '1'
  _jetpack_related_posts_cache: a:1:{s:32:"8f6677c9d6b0f903e98ad32ec61f8deb";a:2:{s:7:"expires";i:1567368374;s:7:"payload";a:3:{i:0;a:1:{s:2:"id";i:879;}i:1;a:1:{s:2:"id";i:898;}i:2;a:1:{s:2:"id";i:871;}}}}
  dsq_thread_id: '6177881878'
author:
  login: egongu90
  email: egongu90@hotmail.com
  display_name: Editor
  first_name: ''
  last_name: ''
permalink: "/legacy-network/"
---
<h4>CONTROLLER</h4>
<p>En controller node configuraremos nova para el uso de legacy network.</p>
<blockquote><p># openstack-config --set /etc/nova/nova.conf DEFAULT network_api_class nova.network.api.API</p>
<p># openstack-config --set /etc/nova/nova.conf DEFAULT security_group_api nova</p></blockquote>
<p>Reiniciamos los servicios para que aplique la configuración.</p>
<blockquote><p># service openstack-nova api restart</p>
<p># service openstack-nova-scheduler restart</p>
<p># service openstack-nova-conductor restart</p></blockquote>
<h4>COMPUTE</h4>
<p>Instalamos los paquetes de nova-network en controller node.</p>
<blockquote><p># yum install openstack-nova-network openstack-nova-api</p></blockquote>
<p>Configuramos varias opciones en nova para el uso de legacy network.</p>
<blockquote><p># openstack-config --set /etc/nova/nova.conf DEFAULT network_api_class nova.network.api.API</p>
<p># openstack-config --set /etc/nova/nova.conf DEFAULT security_group_api nova</p>
<p># openstack-config --set /etc/nova/nova.conf DEFAULT network_manager      nova.network.manager.FlatDHCPManager</p>
<p># openstack-config --set /etc/nova/nova.conf DEFAULT firewall_driver    nova.virt.libvirt.firewall.IptablesFirewallDriver</p>
<p># openstack-config --set /etc/nova/nova.conf DEFAULT network_size 254</p>
<p># openstack-config --set /etc/nova/nova.conf DEFAULT allow_same_net_traffic False</p>
<p># openstack-config --set /etc/nova/nova.conf DEFAULT multi_host True</p>
<p># openstack-config --set /etc/nova/nova.conf DEFAULT send_arp_for_ha True</p>
<p># openstack-config --set /etc/nova/nova.conf DEFAULT force_dhcp_release True</p>
<p># openstack-config --set /etc/nova/nova.conf DEFAULT share_dhcp_address True</p>
<p># openstack-config --set /etc/nova/nova.conf DEFAULT flat_network_bridge br100</p>
<p># openstack-config --set /etc/nova/nova.conf DEFAULT flat_interface eth1</p>
<p># openstack-config --set /etc/nova/nova.conf DEFAULT public_interface eth1</p></blockquote>
<p>Iniciamos los servicios y establecemos el arranque con el host.</p>
<blockquote><p># service openstack-nova-network start</p>
<p># service openstack-nova-metadata-api start</p>
<p># chkconfig openstack-nova-network on</p>
<p># chkconfig openstack-nova-metadata-api on</p></blockquote>
<h4>CREAR REDES</h4>
<p>Ahora crearemos la primera red.</p>
<blockquote><p># nova network-create [name] --bridge br100 --multi-host T --fixed-range-v4 [IP_RANGE/*]</p></blockquote>
<p>Ejemplo, teniendo en cuenta que mi NAT usa el rango 192.168.207.0/24:</p>
<blockquote><p># nova network-create demo-net --bridge br100 --multi-host T --fixed-range-v4 192.168.207.0/24</p></blockquote>
<p>Listamos la red.</p>
<blockquote><p># nova net-list</p></blockquote>
<p>Podemos borrarla de la siguiente forma:</p>
<blockquote><p># nova net-delete [nombre o ID]</p></blockquote>
