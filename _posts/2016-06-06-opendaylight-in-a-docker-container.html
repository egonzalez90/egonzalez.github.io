---
layout: post
title: OpenDaylight in a Docker container
date: 2016-06-06 18:26:22.000000000 +02:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Linux
- Various
tags:
- "--configure"
- container
- controller
- docker
- install
- OpenDaylight
- sdn
meta:
  _wpcom_is_markdown: '1'
  _edit_last: '2'
  _aioseop_opengraph_settings: a:13:{s:32:"aioseop_opengraph_settings_title";s:34:"OpenDaylight
    in a Docker container";s:31:"aioseop_opengraph_settings_desc";s:57:"Configure
    OpenDaylight in a Docker container, quick guide";s:32:"aioseop_opengraph_settings_image";s:73:"http://egonzalez.org/wp-content/uploads/2016/06/Selection_001-150x150.png";s:36:"aioseop_opengraph_settings_customimg";s:73:"http://egonzalez.org/wp-content/uploads/2016/06/Selection_001-150x150.png";s:37:"aioseop_opengraph_settings_imagewidth";s:0:"";s:38:"aioseop_opengraph_settings_imageheight";s:0:"";s:32:"aioseop_opengraph_settings_video";s:0:"";s:37:"aioseop_opengraph_settings_videowidth";s:0:"";s:38:"aioseop_opengraph_settings_videoheight";s:0:"";s:35:"aioseop_opengraph_settings_category";s:8:"activity";s:34:"aioseop_opengraph_settings_section";s:0:"";s:30:"aioseop_opengraph_settings_tag";s:0:"";s:34:"aioseop_opengraph_settings_setcard";s:7:"summary";}
  _publicize_twitter_user: "@egongu90"
  _oembed_c5d0bac511a4da97adef21e52a67c0a3: "{{unknown}}"
  _jetpack_related_posts_cache: a:1:{s:32:"8f6677c9d6b0f903e98ad32ec61f8deb";a:2:{s:7:"expires";i:1568921051;s:7:"payload";a:3:{i:0;a:1:{s:2:"id";i:1087;}i:1;a:1:{s:2:"id";i:1286;}i:2;a:1:{s:2:"id";i:1213;}}}}
  _thumbnail_id: '1226'
  _wpas_done_all: '1'
  _wpas_skip_5226565: '1'
  _wpas_skip_10228321: '1'
  _wpas_skip_12345373: '1'
  _wpas_skip_8706018: '1'
  _aioseop_keywords: OpenDaylight,docker,sdn,container,controller,install,configure
  _aioseop_description: Configure OpenDaylight in a Docker container, quick guide
  _aioseop_title: OpenDaylight in a Docker container
  dsq_thread_id: '6094353487'
author:
  login: egongu90
  email: egongu90@hotmail.com
  display_name: Editor
  first_name: ''
  last_name: ''
permalink: "/opendaylight-in-a-docker-container/"
---
<p>This is a quick guide to start a Docker container with OpenDaylight running on it.</p>
<p>Clone OpenDaylight integration repository</p>
<pre>[egonzalez@localhost]$ git clone https://github.com/opendaylight/integration.git
</pre>
<p>Move to the directory where CentOS Dockerfile is saved.</p>
<pre>[egonzalez@localhost]$ cd integration/packaging/docker/centos/
</pre>
<p>Build the new image, you can call it as your DockerHub name(in my case egonzalez90), so you can push it there later.<br />
If you don't want to create a new image, you can use my image. This step will download and start the new container: <code>docker run -d egonzalez90/opendaylight</code></p>
<pre>[egonzalez@localhost centos]$ docker build -t egonzalez90/opendaylight .

Sending build context to Docker daemon  7.68 kB
Step 1 : FROM centos:7
Trying to pull repository docker.io/library/centos ... 7: Pulling from library/centos
1544084fad81: Pull complete 
df0fc3863fbc: Pull complete 
a3d54b467fad: Pull complete 
a65193109361: Pull complete 
Digest: sha256:a9237ff42b09cc6f610bab60a36df913ef326178a92f3b61631331867178f982
Status: Downloaded newer image for docker.io/centos:7

 ---&gt; a65193109361
Step 2 : MAINTAINER OpenDaylight Project &lt;info@opendaylight.org&gt;
 ---&gt; Running in d3f98f949b11
 ---&gt; 81a1bad2e3a7
Removing intermediate container d3f98f949b11
Step 3 : ADD opendaylight-3-candidate.repo /etc/yum.repos.d/
 ---&gt; 069a9c60878e
Removing intermediate container b9afb18311f3
Step 4 : RUN yum update -y &amp;&amp; yum install -y opendaylight
 ---&gt; Running in 559b3970235d

[[[ PACKAGE INSTALLATION STUFF ]]]                                      

Complete!
 ---&gt; 4003e5874b03
Removing intermediate container 559b3970235d
Step 5 : EXPOSE 162 179 1088 1790 1830 2400 2550 2551 2552 4189 4342 5005 5666 6633 6640 6653 7800 8000 8080 8101 8181 8383 12001
 ---&gt; Running in 7defebe8b7e2
 ---&gt; 9668a559bdac
Removing intermediate container 7defebe8b7e2
Step 6 : WORKDIR /opt/opendaylight
 ---&gt; Running in 9298a116dd14
 ---&gt; 5bf42f56e282
Removing intermediate container 9298a116dd14
Step 7 : CMD ./bin/karaf server
 ---&gt; Running in e0a218941b15
 ---&gt; c1a0db72dbbc
Removing intermediate container e0a218941b15
Successfully built c1a0db72dbbc
</pre>
<p>Once the image is built or downloaded, ensure you have it locally</p>
<pre>[egonzalez@localhost]$ docker images | grep opendaylight
egonzalez90/opendaylight                              latest              c1a0db72dbbc        About a minute ago   740.6 MB
</pre>
<p>Start a new container in a detached mode.</p>
<pre>[egonzalez@localhost]$ docker run -d egonzalez90/opendaylight
ae08898ba6adc30df012513dc6eac54943d9de8c8059e73ade185757fe684c6a
Usage of loopback devices is strongly discouraged for production use. Either use `--storage-opt dm.thinpooldev` or use `--storage-opt dm.no_warn_on_loop_devices=true` to suppress this warning.
</pre>
<p>Check if the container is running with:</p>
<pre>[egonzalez@localhost]$ docker ps | grep opendaylight 
ae08898ba6ad        egonzalez90/opendaylight   "./bin/karaf server"     14 seconds ago      Up 11 seconds       162/tcp, 179/tcp, 1088/tcp, 1790/tcp, 1830/tcp, 2400/tcp, 2550-2552/tcp, 4189/tcp, 4342/tcp, 5005/tcp, 5666/tcp, 6633/tcp, 6640/tcp, 6653/tcp, 7800/tcp, 8000/tcp, 8080/tcp, 8101/tcp, 8181/tcp, 8383/tcp, 12001/tcp   awesome_khorana
</pre>
<p>Now, check container information with docker inspect, we search for the IP address</p>
<pre>[egonzalez@localhost]$ docker inspect  ae08898ba6ad | grep -i IPAddress
        "SecondaryIPAddresses": null,
        "IPAddress": "172.17.0.3",
                "IPAddress": "172.17.0.3",
</pre>
<p>Now you know the container IP address, to login into karaf, first we need to download and install karaf client tool<br />
Go to the following URL to download the package: <a href="http://www.apache.org/dyn/closer.lua/karaf/4.0.5/apache-karaf-4.0.5.tar.gz" target="_blank">http://www.apache.org/dyn/closer.lua/karaf/4.0.5/apache-karaf-4.0.5.tar.gz</a></p>
<p>Extract the files and move to the new directory</p>
<pre>[egonzalez@localhost Downloads]$ tar -xzvf apache-karaf-4.0.5.tar.gz 
[egonzalez@localhost Downloads]$ cd apache-karaf-4.0.5/
</pre>
<p>Execute the client authenticating with the container IP</p>
<pre>[egonzalez@localhost apache-karaf-4.0.5]$ ./bin/client -a 8101 -h 172.17.0.3 -u karaf -v
client: JAVA_HOME not set; results may vary
13 [main] INFO org.apache.sshd.common.util.SecurityUtils - BouncyCastle not registered, using the default JCE provider
Logging in as karaf
194 [sshd-SshClient[12bb4df8]-nio2-thread-1] INFO org.apache.sshd.client.session.ClientSessionImpl - Client session created
203 [main] INFO org.apache.sshd.client.session.ClientSessionImpl - Start flagging packets as pending until key exchange is done
204 [sshd-SshClient[12bb4df8]-nio2-thread-1] INFO org.apache.sshd.client.session.ClientSessionImpl - Server version string: SSH-2.0-SSHD-CORE-0.12.0
321 [sshd-SshClient[12bb4df8]-nio2-thread-3] WARN org.apache.sshd.client.keyverifier.AcceptAllServerKeyVerifier - Server at /172.17.0.3:8101 presented unverified DSA key: 09:a0:45:95:7a:dd:94:7c:6b:c3:f9:c0:23:88:1d:b0
324 [sshd-SshClient[12bb4df8]-nio2-thread-3] INFO org.apache.sshd.client.session.ClientSessionImpl - Dequeing pending packets
327 [sshd-SshClient[12bb4df8]-nio2-thread-4] INFO org.apache.sshd.client.session.ClientUserAuthServiceNew - Received SSH_MSG_USERAUTH_FAILURE
338 [sshd-SshClient[12bb4df8]-nio2-thread-5] INFO org.apache.sshd.client.session.ClientUserAuthServiceNew - Received SSH_MSG_USERAUTH_FAILURE
341 [sshd-SshClient[12bb4df8]-nio2-thread-6] INFO org.apache.sshd.client.auth.UserAuthKeyboardInteractive - Received Password authentication  en-US
344 [sshd-SshClient[12bb4df8]-nio2-thread-7] INFO org.apache.sshd.client.session.ClientUserAuthServiceNew - Received SSH_MSG_USERAUTH_SUCCESS
                                                                                           
    ________                       ________                .__  .__       .__     __       
    \_____  \ ______   ____   ____ \______ \ _____  ___.__.|  | |__| ____ |  |___/  |_     
     /   |   \\____ \_/ __ \ /    \ |    |  \\__  \&lt; | || | | |/ ___\| | \ __\ / | \ |_&gt; &gt;  ___/|   |  \|    `   \/ __ \\___  ||  |_|  / /_/  &gt;   Y  \  |      
    \_______  /   __/ \___  &gt;___|  /_______  (____  / ____||____/__\___  /|___|  /__|      
            \/|__|        \/     \/        \/     \/\/            /_____/      \/          
                                                                                           

Hit '' for a list of available commands
and '[cmd] --help' for help on a specific command.
Hit '' or type 'system:shutdown' or 'logout' to shutdown OpenDaylight.
</pre>
<p>Once karaf login succeed, install a few features like DLUX</p>
<pre>opendaylight-user@root&gt;feature:install odl-restconf odl-l2switch-switch odl-mdsal-apidocs odl-dlux-core
</pre>
<p>Now you can login at the container IP with admin as username and password.</p>
<pre>http://172.17.0.3:8181/index.html
</pre>
<p><img class="aligncenter wp-image-1226 size-full" src="{{ site.baseurl }}/assets/Selection_001.png" alt="Selection_001" width="774" height="619" /></p>
<p>Best regards</p>
