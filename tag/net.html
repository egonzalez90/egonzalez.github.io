<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>OpenStack Stuff - net</title>
        <link rel="stylesheet" href="https://egonzalez90.github.io/theme/css/main.css" />
        <link href="https://egonzalez90.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="OpenStack Stuff Atom Feed" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://egonzalez90.github.io/">OpenStack Stuff </a></h1>
                <nav><ul>
                    <li><a href="https://docs.openstack.org">OpenStack</a></li>
                    <li><a href="https://www.linkedin.com/in/eduardogonzalezgutierrez">Linkedin</a></li>
                    <li><a href="https://github.com/egonzalez90">Github</a></li>
                    <li><a href="https://egonzalez90.github.io/category/linux.html">Linux</a></li>
                    <li><a href="https://egonzalez90.github.io/category/linux-openstack.html">Linux, OpenStack</a></li>
                    <li><a href="https://egonzalez90.github.io/category/linux-openstack-various.html">Linux, OpenStack, Various</a></li>
                    <li><a href="https://egonzalez90.github.io/category/linux-various.html">Linux, Various</a></li>
                    <li><a href="https://egonzalez90.github.io/category/linux-virtualizacion.html">Linux, Virtualizacion</a></li>
                    <li><a href="https://egonzalez90.github.io/category/misc.html">misc</a></li>
                    <li><a href="https://egonzalez90.github.io/category/openstack.html">OpenStack</a></li>
                    <li><a href="https://egonzalez90.github.io/category/reflexiones.html">Reflexiones</a></li>
                    <li><a href="https://egonzalez90.github.io/category/various.html">Various</a></li>
                    <li><a href="https://egonzalez90.github.io/category/virtualizacion.html">Virtualizacion</a></li>
                </ul>
                </nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="https://egonzalez90.github.io/delete-openstack-neutron-networks-solution-to-unable-to-complete-operation-on-subnet.html">Delete openstack Neutron networks (Solution to: Unable to complete operation on subnet)</a></h1>
<footer class="post-info">
        <span>Mon 09 March 2015</span>
<span>| tags: <a href="https://egonzalez90.github.io/tag/cannot-be-deleted-directly-via-the-port-api.html">cannot be deleted directly via the port API</a><a href="https://egonzalez90.github.io/tag/delete.html">delete</a><a href="https://egonzalez90.github.io/tag/error.html">error</a><a href="https://egonzalez90.github.io/tag/floatingip.html">floatingip</a><a href="https://egonzalez90.github.io/tag/guide.html">guide</a><a href="https://egonzalez90.github.io/tag/has-owner-networkfloatingip.html">has owner network:floatingip</a><a href="https://egonzalez90.github.io/tag/net.html">net</a><a href="https://egonzalez90.github.io/tag/network.html">network</a><a href="https://egonzalez90.github.io/tag/neutron.html">neutron</a><a href="https://egonzalez90.github.io/tag/openstack.html">openstack</a><a href="https://egonzalez90.github.io/tag/port.html">port</a><a href="https://egonzalez90.github.io/tag/router.html">router</a><a href="https://egonzalez90.github.io/tag/solution.html">solution</a><a href="https://egonzalez90.github.io/tag/step-by-step.html">step by step</a><a href="https://egonzalez90.github.io/tag/subnet.html">subnet</a><a href="https://egonzalez90.github.io/tag/unable-to-complete-operation-on-subnet.html">Unable to complete operation on subnet</a></span>
</footer><!-- /.post-info --><div class="highlight"><pre><span></span>[root@rdoicehouse ~(keystone_admin)]# neutron router-list
+--------------------------------------+------------------+-----------------------------------------------------------------------------+
| id                                   | name             | external_gateway_info                                                       |
+--------------------------------------+------------------+-----------------------------------------------------------------------------+
| e34d94ad-7fe1-4704-8156-d255a2daa167 | demodeleterouter | {&quot;network_id&quot;: &quot;8b2ceda2-4d77-4c5c-ae21-6a7ba133e4fc&quot;, &quot;enable_snat&quot;: true} |
+--------------------------------------+------------------+-----------------------------------------------------------------------------+

[root@rdoicehouse ~(keystone_admin)]# neutron router-gateway-clear e34d94ad-7fe1-4704-8156-d255a2daa167
Removed gateway from router e34d94ad-7fe1-4704-8156-d255a2daa167

[root@rdoicehouse ~(keystone_admin)]# neutron router-port-list e34d94ad-7fe1-4704-8156-d255a2daa167

If Apply: 
          [[ neutron router-interface-delete &lt;router-id&gt; &lt;subnet-id&gt; ]]

[root@rdoicehouse ~(keystone_admin)]# neutron router-delete e34d94ad-7fe1-4704-8156-d255a2daa167
Deleted router: e34d94ad-7fe1-4704-8156-d255a2daa167

[root@rdoicehouse ~(keystone_admin)]# neutron subnet-list
+--------------------------------------+------------------+------------------+--------------------------------------------------------+
| id                                   | name             | cidr             | allocation_pools                                       |
+--------------------------------------+------------------+------------------+--------------------------------------------------------+
| d50e28f7-47ee-4bdf-8594-e1108f25586b | demosubnetdelete | 192.168.137.0/24 | {&quot;start&quot;: &quot;192.168.137.100&quot;, &quot;end&quot;: &quot;192.168.137.120&quot;} |
| c93fd5a7-d672-4b0c-8f2e-6e74f487e45d | private_subnet   | 10.0.0.0/24      | {&quot;start&quot;: &quot;10.0.0.2&quot;, &quot;end&quot;: &quot;10.0.0.254&quot;}             |
+--------------------------------------+------------------+------------------+--------------------------------------------------------+
[root@rdoicehouse ~(keystone_admin)]# neutron subnet-delete d50e28f7-47ee-4bdf-8594-e1108f25586b
409-{u&#39;NeutronError&#39;: {u&#39;message&#39;: u&#39;Unable to complete operation on subnet d50e28f7-47ee-4bdf-8594-e1108f25586b. One or more ports have an IP allocation from this subnet.&#39;, u&#39;type&#39;: u&#39;SubnetInUse&#39;, u&#39;detail&#39;: u&#39;&#39;}}

[root@rdoicehouse ~(keystone_admin)]# neutron port-list
+--------------------------------------+------+-------------------+----------------------------------------------------------------------------------------+
| id                                   | name | mac_address       | fixed_ips                                                                              |
+--------------------------------------+------+-------------------+----------------------------------------------------------------------------------------+
| 4655e13a-9767-4750-8f44-4eee8410ca70 |      | fa:16:3e:03:c7:cf | {&quot;subnet_id&quot;: &quot;d50e28f7-47ee-4bdf-8594-e1108f25586b&quot;, &quot;ip_address&quot;: &quot;192.168.137.103&quot;} |
| 767f2f83-f99a-46d1-b2c2-2e47bae4bb90 |      | fa:16:3e:ff:94:28 | {&quot;subnet_id&quot;: &quot;d50e28f7-47ee-4bdf-8594-e1108f25586b&quot;, &quot;ip_address&quot;: &quot;192.168.137.102&quot;} |
+--------------------------------------+------+-------------------+----------------------------------------------------------------------------------------+

[root@rdoicehouse ~(keystone_admin)]# neutron port-delete 767f2f83-f99a-46d1-b2c2-2e47bae4bb90
Deleted port: 767f2f83-f99a-46d1-b2c2-2e47bae4bb90

[root@rdoicehouse ~(keystone_admin)]# neutron port-delete 4655e13a-9767-4750-8f44-4eee8410ca70
409-{u&#39;NeutronError&#39;: {u&#39;message&#39;: u&#39;Port 4655e13a-9767-4750-8f44-4eee8410ca70 has owner network:floatingip and therefore cannot be deleted directly via the port API.&#39;, u&#39;type&#39;: u&#39;L3PortInUse&#39;, u&#39;detail&#39;: u&#39;&#39;}}

[root@rdoicehouse ~(keystone_admin)]# neutron floatingip-list
+--------------------------------------+------------------+---------------------+---------+
| id                                   | fixed_ip_address | floating_ip_address | port_id |
+--------------------------------------+------------------+---------------------+---------+
| 0a74679b-b469-4ae5-97a0-08c3aeeb2129 |                  | 192.168.137.103     |         |
+--------------------------------------+------------------+---------------------+---------+

[root@rdoicehouse ~(keystone_admin)]# neutron floatingip-delete 0a74679b-b469-4ae5-97a0-08c3aeeb2129
Deleted floatingip: 0a74679b-b469-4ae5-97a0-08c3aeeb2129

[root@rdoicehouse ~(keystone_admin)]# neutron port-list

[root@rdoicehouse ~(keystone_admin)]# neutron subnet-delete d50e28f7-47ee-4bdf-8594-e1108f25586b
Deleted subnet: d50e28f7-47ee-4bdf-8594-e1108f25586b

[root@rdoicehouse ~(keystone_admin)]# neutron net-list
+--------------------------------------+------------+--------------------------------------------------+
| id                                   | name       | subnets                                          |
+--------------------------------------+------------+--------------------------------------------------+
| 77dd5a93-b63e-44be-84d6-f6ef4fd8771b | private    | c93fd5a7-d672-4b0c-8f2e-6e74f487e45d 10.0.0.0/24 |
| 8b2ceda2-4d77-4c5c-ae21-6a7ba133e4fc | demodelete |                                                  |
+--------------------------------------+------------+--------------------------------------------------+
[root@rdoicehouse ~(keystone_admin)]# neutron net-delete 8b2ceda2-4d77-4c5c-ae21-6a7ba133e4fc
Deleted network: 8b2ceda2-4d77-4c5c-ae21-6a7ba133e4fc
</pre></div><p><a href="https://egonzalez90.github.io/delete-openstack-neutron-networks-solution-to-unable-to-complete-operation-on-subnet.html#disqus_thread">comments</a></p>                </article>
<p class="paginator">
    Page 1 / 1
</p>
            </aside><!-- /#featured -->
            </ol><!-- /#posts-list -->
            </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://egonzalez90.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="https://twitter.com/egongu90">Twitter</a></li>
                            <li><a href="https://www.linkedin.com/in/eduardogonzalezgutierrez">Linkedin</a></li>
                            <li><a href="https://github.com/egonzalez90">Github</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <p>Powered by <a href="http://getpelican.com/">Pelican</a>. Theme <a href="https://github.com/blueicefield/pelican-blueidea/">blueidea</a>, inspired by the default theme.</p>
        </footer><!-- /#contentinfo -->

<script type="text/javascript">
    var disqus_shortname = 'egonzalez-1';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>