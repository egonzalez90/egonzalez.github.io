<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OpenStack Stuff | articles tagged "--configure"</title>
    <link rel="shortcut icon" type="image/png" href="https://egonzalez90.github.io/favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="https://egonzalez90.github.io/favicon.ico">
    <link href="https://egonzalez90.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="OpenStack Stuff Full Atom Feed" />
    <link rel="stylesheet" href="https://egonzalez90.github.io/theme/css/screen.css" type="text/css" />
    <link rel="stylesheet" href="https://egonzalez90.github.io/theme/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="https://egonzalez90.github.io/theme/css/print.css" type="text/css" media="print" />
    <meta name="generator" content="Pelican" />
    <meta name="description" content="" />
    <meta name="author" content="Eduardo Gonzalez" />
</head>
<body>
    <header>
        <nav>
            <ul>
                <li class="ephemeral selected"><a href="https://egonzalez90.github.io/tag/-configure.html">--configure</a></li>
                <li><a href="https://egonzalez90.github.io/">Home</a></li>
                <li><a href="https://docs.openstack.org">OpenStack</a></li>
                <li><a href="https://www.linkedin.com/in/eduardogonzalezgutierrez">Linkedin</a></li>
                <li><a href="https://github.com/egonzalez90">Github</a></li>
                <li><a href="https://egonzalez90.github.io/archives">Archives</a></li>
            </ul>
        </nav>
        <div class="header_box">
            <h1><a href="https://egonzalez90.github.io/">OpenStack Stuff</a></h1>
        </div>
    </header>
    <div id="wrapper">
        <div id="content">            <h4 class="date">Feb 22, 2017</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://egonzalez90.github.io/deploy-openstack-designate-with-kolla-ansible.html" rel="bookmark" title="Permanent Link to &quot;Deploy OpenStack Designate with Kolla&quot;">Deploy OpenStack Designate with Kolla</a>
                </h2>

                
                

                <p>During Ocata release, OpenStack DNS-as-a-Service (Designate) support was
implemented in OpenStack kolla project.</p>
<p>This post will guide you through a basic deployment and tests of
designate service.</p>
<p>Install required dependencies and tools for kolla-ansible and designate.</p>
<div class="highlight"><pre><span></span># yum install -y epel-release
# yum install -y python-pip python-devel libffi-devel gcc openssl-devel ansible ntp wget bind-utils
# pip install -U pip
</pre></div>


<p>Install Docker and downgrade to 1.12.6. At the time of writing this post
libvirt had issues to connect with D-Bus due SElinux issues with Docker
1.13.</p>
<div class="highlight"><pre><span></span># curl -sSL https://get.docker.io | bash
# yum downgrade docker-engine-1.12.6 docker-engine-selinux-1.12.6
# yum install -y python-docker-py
</pre></div>


<p>Configure Docker daemon to allow insecure-registry (Use the IP where
your remote registry will be located).</p>
<div class="highlight"><pre><span></span># mkdir -p /etc/systemd/system/docker.service.d
# tee /etc/systemd/system/docker.service.d/kolla.conf &lt;&lt;-&#39;EOF&#39;
[Service]
ExecStart=
ExecStart=/usr/bin/dockerd --insecure-registry 172.28.128.3:4000
MountFlags=shared
EOF
</pre></div>


<p>Reload systemd daemons and start/stop/disable/enable the following
services.</p>
<div class="highlight"><pre><span></span># systemctl daemon-reload
# systemctl stop libvirtd
# systemctl disable libvirtd
# systemctl enable ntpd docker
# systemctl start ntpd docker
</pre></div>


<p>Download Ocata registry created in tarballs.openstack.org, skip this
step if images used are custom builds or downloaded from DockerHub.<br>
Create kolla registry from downloaded tarball.</p>
<div class="highlight"><pre><span></span># wget https://tarballs.openstack.org/kolla/images/centos-binary-registry-ocata.tar.gz
# mkdir /opt/kolla_registry
# sudo tar xzf centos-binary-registry-ocata.tar.gz -C /opt/kolla_registry
# docker run -d -p 4000:5000 --restart=always -v /opt/kolla_registry/:/var/lib/registry --name registry registry:2
</pre></div>


<p>Install kolla-ansible.</p>
<div class="highlight"><pre><span></span># pip install kolla-ansible
# cp -r /usr/share/kolla-ansible/etc_examples/kolla /etc/kolla/
# cp /usr/share/kolla-ansible/ansible/inventory/* .
</pre></div>


<p>Configure kolla globals.yml configuration file with the following
content.<br>
Change values when necessary (IP addresses, interface names).<br>
This is a sample minimal configuration.</p>
<div class="highlight"><pre><span></span># vi /etc/kolla/globals.yml
---
kolla_internal_vip_address: &quot;172.28.128.10&quot;
kolla_base_distro: &quot;centos&quot;
kolla_install_type: &quot;binary&quot;
docker_registry: &quot;172.28.128.3:4000&quot;
docker_namespace: &quot;lokolla&quot;
network_interface: &quot;enp0s8&quot;
neutron_external_interface: &quot;enp0s9&quot;
</pre></div>


<p>Configure designate options in globals.yml.<br>
dns_interface must be network reachable from nova instances if
internal DNS resolution is needed.</p>
<div class="highlight"><pre><span></span>enable_designate: &quot;yes&quot;
dns_interface: &quot;enp0s8&quot;
designate_backend: &quot;bind9&quot;
designate_ns_record: &quot;sample.openstack.org&quot;
</pre></div>


<p>Configure inventory, add the nodes in their respective groups.</p>
<div class="highlight"><pre><span></span># vi ~/multinode
</pre></div>


<p>Generate passwords.</p>
<div class="highlight"><pre><span></span># kolla-genpwd
</pre></div>


<p>Ensure the environment is ready to deploy with prechecks.<br>
Until prechecks does not succeed do not start deployment.<br>
Fix what is necessary.</p>
<div class="highlight"><pre><span></span># kolla-ansible prechecks -i ~/multinode
</pre></div>


<p>Pull Docker images on the servers, this can be skipped because will be
made in deploy step, but doing it first will ensure all the nodes have
the images you need and will minimize the deployment time.</p>
<div class="highlight"><pre><span></span># kolla-ansible pull -i ~/multinode
</pre></div>


<p>Deploy kolla-ansible and do a woot for kolla ;)</p>
<div class="highlight"><pre><span></span># kolla-ansible deploy -i ~/multinode
</pre></div>


<p>Create credentials file and source it.</p>
<div class="highlight"><pre><span></span># kolla-ansible post-deploy -i ~/multinode
# source /etc/kolla/admin-openrc.sh
</pre></div>


<p>Check that all containers are running and none of them are restarting or
exiting.</p>
<div class="highlight"><pre><span></span># docker ps -a --filter status=exited --filter status=restarting
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
</pre></div>


<p>Install required python clients</p>
<div class="highlight"><pre><span></span># pip install python-openstackclient python-designateclient python-neutronclient
</pre></div>


<p>Execute a base OpenStack configuration (public and internal networks,
cirros image).<br>
Do no execute this script if custom networks are going to be used.</p>
<div class="highlight"><pre><span></span># sh /usr/share/kolla-ansible/init-runonce
</pre></div>


<p>Create a sample designate zone.</p>
<div class="highlight"><pre><span></span># openstack zone create --email admin@sample.openstack.org sample.openstack.org.
+----------------+--------------------------------------+
| Field          | Value                                |
+----------------+--------------------------------------+
| action         | CREATE                               |
| attributes     |                                      |
| created_at     | 2017-02-22T13:14:39.000000           |
| description    | None                                 |
| email          | admin@sample.openstack.org           |
| id             | 4a44b0c9-bd07-4f5c-8908-523f453f269d |
| masters        |                                      |
| name           | sample.openstack.org.                |
| pool_id        | 85d18aec-453e-45ae-9eb3-748841a1da12 |
| project_id     | 937d49af6cfe4ef080a79f9a833d7c7d     |
| serial         | 1487769279                           |
| status         | PENDING                              |
| transferred_at | None                                 |
| ttl            | 3600                                 |
| type           | PRIMARY                              |
| updated_at     | None                                 |
| version        | 1                                    |
+----------------+--------------------------------------+
</pre></div>


<p>Configure designate sink to make use of the previously created zone,
sink will need zone_id to automatically create neutron and nova records
into designate.</p>
<div class="highlight"><pre><span></span># mkdir -p /etc/kolla/config/designate/designate-sink/
# vi /etc/kolla/config/designate/designate-sink.conf
[handler:nova_fixed]
zone_id = 4a44b0c9-bd07-4f5c-8908-523f453f269d
[handler:neutron_floatingip]
zone_id = 4a44b0c9-bd07-4f5c-8908-523f453f269d
</pre></div>


<p>After configure designate-sink.conf, reconfigure designate to make use
of this configuration.</p>
<div class="highlight"><pre><span></span># kolla-ansible reconfigure -i ~/multinode --tags designate
</pre></div>


<p>List networks.</p>
<div class="highlight"><pre><span></span># neutron net-list
+--------------------------------------+----------+----------------------------------+--------------------------------------------------+
| id                                   | name     | tenant_id                        | subnets                                          |
+--------------------------------------+----------+----------------------------------+--------------------------------------------------+
| 3b56c605-5a01-45be-9ed6-e4c3285e4366 | demo-net | 937d49af6cfe4ef080a79f9a833d7c7d | 7f28f050-77b2-426e-b963-35b682077993 10.0.0.0/24 |
| 6954d495-fb8c-4b0b-98a9-9672a7f65b7c | public1  | 937d49af6cfe4ef080a79f9a833d7c7d | 9bd9feca-40a7-4e82-b912-e51b726ad746 10.0.2.0/24 |
+--------------------------------------+----------+----------------------------------+--------------------------------------------------+
</pre></div>


<p>Update the network with a dns_domain.</p>
<div class="highlight"><pre><span></span># neutron net-update 3b56c605-5a01-45be-9ed6-e4c3285e4366 --dns_domain sample.openstack.org.
Updated network: 3b56c605-5a01-45be-9ed6-e4c3285e4366
</pre></div>


<p>Ensure dns_domain is properly applied.</p>
<div class="highlight"><pre><span></span># neutron net-show 3b56c605-5a01-45be-9ed6-e4c3285e4366
+---------------------------+--------------------------------------+
| Field                     | Value                                |
+---------------------------+--------------------------------------+
| admin_state_up            | True                                 |
| availability_zone_hints   |                                      |
| availability_zones        | nova                                 |
| created_at                | 2017-02-22T13:13:06Z                 |
| description               |                                      |
| dns_domain                | sample.openstack.org.                |
| id                        | 3b56c605-5a01-45be-9ed6-e4c3285e4366 |
| ipv4_address_scope        |                                      |
| ipv6_address_scope        |                                      |
| mtu                       | 1450                                 |
| name                      | demo-net                             |
| port_security_enabled     | True                                 |
| project_id                | 937d49af6cfe4ef080a79f9a833d7c7d     |
| provider:network_type     | vxlan                                |
| provider:physical_network |                                      |
| provider:segmentation_id  | 27                                   |
| revision_number           | 6                                    |
| router:external           | False                                |
| shared                    | False                                |
| status                    | ACTIVE                               |
| subnets                   | 7f28f050-77b2-426e-b963-35b682077993 |
| tags                      |                                      |
| tenant_id                 | 937d49af6cfe4ef080a79f9a833d7c7d     |
| updated_at                | 2017-02-22T13:25:16Z                 |
+---------------------------+--------------------------------------+
</pre></div>


<p>Create a new instance in the previously updated network.</p>
<div class="highlight"><pre><span></span># openstack server create   
   --image cirros   
   --flavor m1.tiny   
   --key-name mykey   
   --nic net-id=3b56c605-5a01-45be-9ed6-e4c3285e4366   
   demo1
</pre></div>


<p>Once the instance is ACTIVE, check the IP associated.</p>
<div class="highlight"><pre><span></span># openstack server list
+--------------------------------------+-------+--------+-------------------+------------+
| ID                                   | Name  | Status | Networks          | Image Name |
+--------------------------------------+-------+--------+-------------------+------------+
| d483e4ee-58c2-4e1e-9384-85174630428e | demo1 | ACTIVE | demo-net=10.0.0.3 | cirros     |
+--------------------------------------+-------+--------+-------------------+------------+
</pre></div>


<p>List records in the designate zone.<br>
As you can see there is a record in designate associated with the
instance IP.</p>
<div class="highlight"><pre><span></span># openstack recordset list sample.openstack.org.
+--------------------------------------+----------------------------------+------+-------------------------------------------+--------+--------+
| id                                   | name                             | type | records                                   | status | action |
+--------------------------------------+----------------------------------+------+-------------------------------------------+--------+--------+
| 4f70531e-c325-4ffd-a8d3-8172bd5163b8 | sample.openstack.org.            | SOA  | sample.openstack.org.                     | ACTIVE | NONE   |
|                                      |                                  |      | admin.sample.openstack.org. 1487770304    |        |        |
|                                      |                                  |      | 3586 600 86400 3600                       |        |        |
| a9a09c5f-ccf1-4b52-8400-f36e8faa9549 | sample.openstack.org.            | NS   | sample.openstack.org.                     | ACTIVE | NONE   |
| aa6cd25d-186e-425b-9153-699d8b0811de | 10-0-0-3.sample.openstack.org.   | A    | 10.0.0.3                                  | ACTIVE | NONE   |
| 713650a5-a45e-470b-9539-74e110b15115 | demo1.None.sample.openstack.org. | A    | 10.0.0.3                                  | ACTIVE | NONE   |
| 6506e6f6-f535-45eb-9bfb-4ac1f16c5c9b | demo1.sample.openstack.org.      | A    | 10.0.0.3                                  | ACTIVE | NONE   |
+--------------------------------------+----------------------------------+------+-------------------------------------------+--------+--------+
</pre></div>


<p>Validate that designate resolves the DNS record.<br>
You can use designate mDNS service or directly to bind9 servers to
validate the test.</p>
<div class="highlight"><pre><span></span><span class="cp"># dig +short -p 5354 @172.28.128.3 demo1.sample.openstack.org. A</span>
<span class="mf">10.0.0.3</span>
<span class="cp"># dig +short -p 53 @172.28.128.3 demo1.sample.openstack.org. A</span>
<span class="mf">10.0.0.3</span>
</pre></div>


<p>If you find any issue with designate in kolla-ansible or kolla, please
fill a bug <a href="https://bugs.launchpad.net/kolla-ansible/+filebug">https://bugs.launchpad.net/kolla-ansible/+filebug</a></p>
<p>Regards,<br>
Eduardo Gonzalez</p>
                <div class="clear"></div>

                <div class="info">
                    <a href="https://egonzalez90.github.io/deploy-openstack-designate-with-kolla-ansible.html">posted at 15:39</a>
                    &nbsp;&middot;&nbsp;<a href="https://egonzalez90.github.io/category/openstack.html" rel="tag">OpenStack</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://egonzalez90.github.io/tag/-configure.html" class="tags selected">--configure</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/ansible.html" class="tags">ansible</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/deploy.html" class="tags">deploy</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/designate.html" class="tags">designate</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/dns.html" class="tags">DNS</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/kolla.html" class="tags">kolla</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/kolla-ansible.html" class="tags">kolla-ansible</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/ocata.html" class="tags">ocata</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/openstack.html" class="tags">openstack</a>
                </div>
		<a href="https://egonzalez90.github.io/deploy-openstack-designate-with-kolla-ansible.html#disqus_thread">Click to read and post comments</a>
            </article>            <h4 class="date">Jun 06, 2016</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://egonzalez90.github.io/opendaylight-in-a-docker-container.html" rel="bookmark" title="Permanent Link to &quot;OpenDaylight in a Docker container&quot;">OpenDaylight in a Docker container</a>
                </h2>

                
                

                <p>This is a quick guide to start a Docker container with OpenDaylight
running on it.</p>
<p>Clone OpenDaylight integration repository</p>
<div class="highlight"><pre><span></span>[egonzalez@localhost]$ git clone https://github.com/opendaylight/integration.git
</pre></div>


<p>Move to the directory where CentOS Dockerfile is saved.</p>
<div class="highlight"><pre><span></span>[egonzalez@localhost]$ cd integration/packaging/docker/centos/
</pre></div>


<p>Build the new image, you can call it as your DockerHub name(in my case
egonzalez90), so you can push it there later.<br>
If you don't want to create a new image, you can use my image. This
step will download and start the new container:
<code>docker run -d egonzalez90/opendaylight</code></p>
<div class="highlight"><pre><span></span>[egonzalez@localhost centos]$ docker build -t egonzalez90/opendaylight .

Sending build context to Docker daemon  7.68 kB
Step 1 : FROM centos:7
Trying to pull repository docker.io/library/centos ... 7: Pulling from library/centos
1544084fad81: Pull complete 
df0fc3863fbc: Pull complete 
a3d54b467fad: Pull complete 
a65193109361: Pull complete 
Digest: sha256:a9237ff42b09cc6f610bab60a36df913ef326178a92f3b61631331867178f982
Status: Downloaded newer image for docker.io/centos:7

 ---&gt; a65193109361
Step 2 : MAINTAINER OpenDaylight Project &lt;info@opendaylight.org&gt;
 ---&gt; Running in d3f98f949b11
 ---&gt; 81a1bad2e3a7
Removing intermediate container d3f98f949b11
Step 3 : ADD opendaylight-3-candidate.repo /etc/yum.repos.d/
 ---&gt; 069a9c60878e
Removing intermediate container b9afb18311f3
Step 4 : RUN yum update -y &amp;&amp; yum install -y opendaylight
 ---&gt; Running in 559b3970235d

[[[ PACKAGE INSTALLATION STUFF ]]]

Complete!
 ---&gt; 4003e5874b03
Removing intermediate container 559b3970235d
Step 5 : EXPOSE 162 179 1088 1790 1830 2400 2550 2551 2552 4189 4342 5005 5666 6633 6640 6653 7800 8000 8080 8101 8181 8383 12001
 ---&gt; Running in 7defebe8b7e2
 ---&gt; 9668a559bdac
Removing intermediate container 7defebe8b7e2
Step 6 : WORKDIR /opt/opendaylight
 ---&gt; Running in 9298a116dd14
 ---&gt; 5bf42f56e282
Removing intermediate container 9298a116dd14
Step 7 : CMD ./bin/karaf server
 ---&gt; Running in e0a218941b15
 ---&gt; c1a0db72dbbc
Removing intermediate container e0a218941b15
Successfully built c1a0db72dbbc
</pre></div>


<p>Once the image is built or downloaded, ensure you have it locally</p>
<div class="highlight"><pre><span></span>[egonzalez@localhost]$ docker images | grep opendaylight
egonzalez90/opendaylight                              latest              c1a0db72dbbc        About a minute ago   740.6 MB
</pre></div>


<p>Start a new container in a detached mode.</p>
<div class="highlight"><pre><span></span>[egonzalez@localhost]$ docker run -d egonzalez90/opendaylight
ae08898ba6adc30df012513dc6eac54943d9de8c8059e73ade185757fe684c6a
Usage of loopback devices is strongly discouraged for production use. Either use `--storage-opt dm.thinpooldev` or use `--storage-opt dm.no_warn_on_loop_devices=true` to suppress this warning.
</pre></div>


<p>Check if the container is running with:</p>
<div class="highlight"><pre><span></span>[egonzalez@localhost]$ docker ps | grep opendaylight 
ae08898ba6ad        egonzalez90/opendaylight   &quot;./bin/karaf server&quot;     14 seconds ago      Up 11 seconds       162/tcp, 179/tcp, 1088/tcp, 1790/tcp, 1830/tcp, 2400/tcp, 2550-2552/tcp, 4189/tcp, 4342/tcp, 5005/tcp, 5666/tcp, 6633/tcp, 6640/tcp, 6653/tcp, 7800/tcp, 8000/tcp, 8080/tcp, 8101/tcp, 8181/tcp, 8383/tcp, 12001/tcp   awesome_khorana
</pre></div>


<p>Now, check container information with docker inspect, we search for the
IP address</p>
<div class="highlight"><pre><span></span>[egonzalez@localhost]$ docker inspect  ae08898ba6ad | grep -i IPAddress
        &quot;SecondaryIPAddresses&quot;: null,
        &quot;IPAddress&quot;: &quot;172.17.0.3&quot;,
                &quot;IPAddress&quot;: &quot;172.17.0.3&quot;,
</pre></div>


<p>Now you know the container IP address, to login into karaf, first we
need to download and install karaf client tool<br>
Go to the following URL to download the package:
<a href="http://www.apache.org/dyn/closer.lua/karaf/4.0.5/apache-karaf-4.0.5.tar.gz">http://www.apache.org/dyn/closer.lua/karaf/4.0.5/apache-karaf-4.0.5.tar.gz</a></p>
<p>Extract the files and move to the new directory</p>
<div class="highlight"><pre><span></span>[egonzalez@localhost Downloads]$ tar -xzvf apache-karaf-4.0.5.tar.gz 
[egonzalez@localhost Downloads]$ cd apache-karaf-4.0.5/
</pre></div>


<p>Execute the client authenticating with the container IP</p>
<div class="highlight"><pre><span></span><span class="cp">[</span><span class="nx">egonzalez</span><span class="p">@</span><span class="nx">localhost</span> <span class="nx">apache</span><span class="na">-karaf</span><span class="o">-</span><span class="mf">4.0.5</span><span class="cp">]</span><span class="o">$</span> <span class="o">./</span><span class="nt">bin</span><span class="o">/</span><span class="nt">client</span> <span class="nt">-a</span> <span class="nt">8101</span> <span class="nt">-h</span> <span class="nt">172</span><span class="p">.</span><span class="nc">17</span><span class="p">.</span><span class="nc">0</span><span class="p">.</span><span class="nc">3</span> <span class="nt">-u</span> <span class="nt">karaf</span> <span class="nt">-v</span>
<span class="nt">client</span><span class="o">:</span> <span class="nt">JAVA_HOME</span> <span class="nt">not</span> <span class="nt">set</span><span class="o">;</span> <span class="nt">results</span> <span class="nt">may</span> <span class="nt">vary</span>
<span class="nt">13</span> <span class="cp">[</span><span class="nx">main</span><span class="cp">]</span> <span class="nt">INFO</span> <span class="nt">org</span><span class="p">.</span><span class="nc">apache</span><span class="p">.</span><span class="nc">sshd</span><span class="p">.</span><span class="nc">common</span><span class="p">.</span><span class="nc">util</span><span class="p">.</span><span class="nc">SecurityUtils</span> <span class="nt">-</span> <span class="nt">BouncyCastle</span> <span class="nt">not</span> <span class="nt">registered</span><span class="o">,</span> <span class="nt">using</span> <span class="nt">the</span> <span class="nt">default</span> <span class="nt">JCE</span> <span class="nt">provider</span>
<span class="nt">Logging</span> <span class="nt">in</span> <span class="nt">as</span> <span class="nt">karaf</span>
<span class="nt">194</span> <span class="cp">[</span><span class="nx">sshd</span><span class="na">-SshClient</span><span class="err">[</span><span class="mi">12</span><span class="nx">bb4df8</span><span class="cp">]</span><span class="nt">-nio2-thread-1</span><span class="o">]</span> <span class="nt">INFO</span> <span class="nt">org</span><span class="p">.</span><span class="nc">apache</span><span class="p">.</span><span class="nc">sshd</span><span class="p">.</span><span class="nc">client</span><span class="p">.</span><span class="nc">session</span><span class="p">.</span><span class="nc">ClientSessionImpl</span> <span class="nt">-</span> <span class="nt">Client</span> <span class="nt">session</span> <span class="nt">created</span>
<span class="nt">203</span> <span class="cp">[</span><span class="nx">main</span><span class="cp">]</span> <span class="nt">INFO</span> <span class="nt">org</span><span class="p">.</span><span class="nc">apache</span><span class="p">.</span><span class="nc">sshd</span><span class="p">.</span><span class="nc">client</span><span class="p">.</span><span class="nc">session</span><span class="p">.</span><span class="nc">ClientSessionImpl</span> <span class="nt">-</span> <span class="nt">Start</span> <span class="nt">flagging</span> <span class="nt">packets</span> <span class="nt">as</span> <span class="nt">pending</span> <span class="nt">until</span> <span class="nt">key</span> <span class="nt">exchange</span> <span class="nt">is</span> <span class="nt">done</span>
<span class="nt">204</span> <span class="cp">[</span><span class="nx">sshd</span><span class="na">-SshClient</span><span class="err">[</span><span class="mi">12</span><span class="nx">bb4df8</span><span class="cp">]</span><span class="nt">-nio2-thread-1</span><span class="o">]</span> <span class="nt">INFO</span> <span class="nt">org</span><span class="p">.</span><span class="nc">apache</span><span class="p">.</span><span class="nc">sshd</span><span class="p">.</span><span class="nc">client</span><span class="p">.</span><span class="nc">session</span><span class="p">.</span><span class="nc">ClientSessionImpl</span> <span class="nt">-</span> <span class="nt">Server</span> <span class="nt">version</span> <span class="nt">string</span><span class="o">:</span> <span class="nt">SSH-2</span><span class="p">.</span><span class="nc">0-SSHD-CORE-0</span><span class="p">.</span><span class="nc">12</span><span class="p">.</span><span class="nc">0</span>
<span class="nt">321</span> <span class="cp">[</span><span class="nx">sshd</span><span class="na">-SshClient</span><span class="err">[</span><span class="mi">12</span><span class="nx">bb4df8</span><span class="cp">]</span><span class="nt">-nio2-thread-3</span><span class="o">]</span> <span class="nt">WARN</span> <span class="nt">org</span><span class="p">.</span><span class="nc">apache</span><span class="p">.</span><span class="nc">sshd</span><span class="p">.</span><span class="nc">client</span><span class="p">.</span><span class="nc">keyverifier</span><span class="p">.</span><span class="nc">AcceptAllServerKeyVerifier</span> <span class="nt">-</span> <span class="nt">Server</span> <span class="nt">at</span> <span class="o">/</span><span class="nt">172</span><span class="p">.</span><span class="nc">17</span><span class="p">.</span><span class="nc">0</span><span class="p">.</span><span class="nc">3</span><span class="p">:</span><span class="nd">8101</span> <span class="nt">presented</span> <span class="nt">unverified</span> <span class="nt">DSA</span> <span class="nt">key</span><span class="o">:</span> <span class="nt">09</span><span class="p">:</span><span class="nd">a0</span><span class="p">:</span><span class="nd">45</span><span class="p">:</span><span class="nd">95</span><span class="p">:</span><span class="nd">7a</span><span class="p">:</span><span class="nd">dd</span><span class="p">:</span><span class="nd">94</span><span class="p">:</span><span class="nd">7c</span><span class="p">:</span><span class="nd">6b</span><span class="p">:</span><span class="nd">c3</span><span class="p">:</span><span class="nd">f9</span><span class="p">:</span><span class="nd">c0</span><span class="p">:</span><span class="nd">23</span><span class="p">:</span><span class="nd">88</span><span class="p">:</span><span class="nd">1d</span><span class="p">:</span><span class="nd">b0</span>
<span class="nt">324</span> <span class="cp">[</span><span class="nx">sshd</span><span class="na">-SshClient</span><span class="err">[</span><span class="mi">12</span><span class="nx">bb4df8</span><span class="cp">]</span><span class="nt">-nio2-thread-3</span><span class="o">]</span> <span class="nt">INFO</span> <span class="nt">org</span><span class="p">.</span><span class="nc">apache</span><span class="p">.</span><span class="nc">sshd</span><span class="p">.</span><span class="nc">client</span><span class="p">.</span><span class="nc">session</span><span class="p">.</span><span class="nc">ClientSessionImpl</span> <span class="nt">-</span> <span class="nt">Dequeing</span> <span class="nt">pending</span> <span class="nt">packets</span>
<span class="nt">327</span> <span class="cp">[</span><span class="nx">sshd</span><span class="na">-SshClient</span><span class="err">[</span><span class="mi">12</span><span class="nx">bb4df8</span><span class="cp">]</span><span class="nt">-nio2-thread-4</span><span class="o">]</span> <span class="nt">INFO</span> <span class="nt">org</span><span class="p">.</span><span class="nc">apache</span><span class="p">.</span><span class="nc">sshd</span><span class="p">.</span><span class="nc">client</span><span class="p">.</span><span class="nc">session</span><span class="p">.</span><span class="nc">ClientUserAuthServiceNew</span> <span class="nt">-</span> <span class="nt">Received</span> <span class="nt">SSH_MSG_USERAUTH_FAILURE</span>
<span class="nt">338</span> <span class="cp">[</span><span class="nx">sshd</span><span class="na">-SshClient</span><span class="err">[</span><span class="mi">12</span><span class="nx">bb4df8</span><span class="cp">]</span><span class="nt">-nio2-thread-5</span><span class="o">]</span> <span class="nt">INFO</span> <span class="nt">org</span><span class="p">.</span><span class="nc">apache</span><span class="p">.</span><span class="nc">sshd</span><span class="p">.</span><span class="nc">client</span><span class="p">.</span><span class="nc">session</span><span class="p">.</span><span class="nc">ClientUserAuthServiceNew</span> <span class="nt">-</span> <span class="nt">Received</span> <span class="nt">SSH_MSG_USERAUTH_FAILURE</span>
<span class="nt">341</span> <span class="cp">[</span><span class="nx">sshd</span><span class="na">-SshClient</span><span class="err">[</span><span class="mi">12</span><span class="nx">bb4df8</span><span class="cp">]</span><span class="nt">-nio2-thread-6</span><span class="o">]</span> <span class="nt">INFO</span> <span class="nt">org</span><span class="p">.</span><span class="nc">apache</span><span class="p">.</span><span class="nc">sshd</span><span class="p">.</span><span class="nc">client</span><span class="p">.</span><span class="nc">auth</span><span class="p">.</span><span class="nc">UserAuthKeyboardInteractive</span> <span class="nt">-</span> <span class="nt">Received</span> <span class="nt">Password</span> <span class="nt">authentication</span>  <span class="nt">en-US</span>
<span class="nt">344</span> <span class="cp">[</span><span class="nx">sshd</span><span class="na">-SshClient</span><span class="err">[</span><span class="mi">12</span><span class="nx">bb4df8</span><span class="cp">]</span><span class="nt">-nio2-thread-7</span><span class="o">]</span> <span class="nt">INFO</span> <span class="nt">org</span><span class="p">.</span><span class="nc">apache</span><span class="p">.</span><span class="nc">sshd</span><span class="p">.</span><span class="nc">client</span><span class="p">.</span><span class="nc">session</span><span class="p">.</span><span class="nc">ClientUserAuthServiceNew</span> <span class="nt">-</span> <span class="nt">Received</span> <span class="nt">SSH_MSG_USERAUTH_SUCCESS</span>

    <span class="nt">________</span>                       <span class="nt">________</span>                <span class="p">.</span><span class="nc">__</span>  <span class="p">.</span><span class="nc">__</span>       <span class="p">.</span><span class="nc">__</span>     <span class="nt">__</span>       
    <span class="err">\</span><span class="nt">_____</span>  <span class="err">\</span> <span class="nt">______</span>   <span class="nt">____</span>   <span class="nt">____</span> <span class="err">\</span><span class="nt">______</span> <span class="err">\</span> <span class="nt">_____</span>  <span class="nt">___</span><span class="p">.</span><span class="nc">__</span><span class="o">.|</span>  <span class="o">|</span> <span class="o">|</span><span class="nt">__</span><span class="o">|</span> <span class="nt">____</span> <span class="o">|</span>  <span class="o">|</span><span class="nt">___</span><span class="o">/</span>  <span class="o">|</span><span class="nt">_</span>     
     <span class="o">/</span>   <span class="o">|</span>   <span class="err">\\</span><span class="nt">____</span> <span class="err">\</span><span class="nt">_</span><span class="o">/</span> <span class="nt">__</span> <span class="err">\</span> <span class="o">/</span>    <span class="err">\</span> <span class="o">|</span>    <span class="o">|</span>  <span class="err">\\</span><span class="nt">__</span>  <span class="err">\</span><span class="o">&lt;</span> <span class="o">|</span> <span class="o">||</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|/</span> <span class="nt">___</span><span class="err">\</span><span class="o">|</span> <span class="o">|</span> <span class="err">\</span> <span class="nt">__</span><span class="err">\</span> <span class="o">/</span> <span class="o">|</span> <span class="err">\</span> <span class="o">|</span><span class="nt">_</span><span class="o">&gt;</span> <span class="o">&gt;</span>  <span class="nt">___</span><span class="o">/|</span>   <span class="o">|</span>  <span class="err">\</span><span class="o">|</span>    <span class="err">`</span>   <span class="err">\</span><span class="o">/</span> <span class="nt">__</span> <span class="err">\\</span><span class="nt">___</span>  <span class="o">||</span>  <span class="o">|</span><span class="nt">_</span><span class="o">|</span>  <span class="o">/</span> <span class="o">/</span><span class="nt">_</span><span class="o">/</span>  <span class="o">&gt;</span>   <span class="nt">Y</span>  <span class="err">\</span>  <span class="o">|</span>      
    <span class="err">\</span><span class="nt">_______</span>  <span class="o">/</span>   <span class="nt">__</span><span class="o">/</span> <span class="err">\</span><span class="nt">___</span>  <span class="o">&gt;</span><span class="nt">___</span><span class="o">|</span>  <span class="o">/</span><span class="nt">_______</span>  <span class="o">(</span><span class="nt">____</span>  <span class="o">/</span> <span class="nt">____</span><span class="o">||</span><span class="nt">____</span><span class="o">/</span><span class="nt">__</span><span class="err">\</span><span class="nt">___</span>  <span class="o">/|</span><span class="nt">___</span><span class="o">|</span>  <span class="o">/</span><span class="nt">__</span><span class="o">|</span>      
            <span class="err">\</span><span class="o">/|</span><span class="nt">__</span><span class="o">|</span>        <span class="err">\</span><span class="o">/</span>     <span class="err">\</span><span class="o">/</span>        <span class="err">\</span><span class="o">/</span>     <span class="err">\</span><span class="o">/</span><span class="err">\</span><span class="o">/</span>            <span class="o">/</span><span class="nt">_____</span><span class="o">/</span>      <span class="err">\</span><span class="o">/</span>


<span class="nt">Hit</span> <span class="s1">&#39;&#39;</span> <span class="nt">for</span> <span class="nt">a</span> <span class="nt">list</span> <span class="nt">of</span> <span class="nt">available</span> <span class="nt">commands</span>
<span class="nt">and</span> <span class="s1">&#39;</span><span class="cp">[</span><span class="nx">cmd</span><span class="cp">]</span><span class="s1"> --help&#39;</span> <span class="nt">for</span> <span class="nt">help</span> <span class="nt">on</span> <span class="nt">a</span> <span class="nt">specific</span> <span class="nt">command</span><span class="o">.</span>
<span class="nt">Hit</span> <span class="s1">&#39;&#39;</span> <span class="nt">or</span> <span class="nt">type</span> <span class="s1">&#39;system:shutdown&#39;</span> <span class="nt">or</span> <span class="s1">&#39;logout&#39;</span> <span class="nt">to</span> <span class="nt">shutdown</span> <span class="nt">OpenDaylight</span><span class="o">.</span>
</pre></div>


<p>Once karaf login succeed, install a few features like DLUX</p>
<div class="highlight"><pre><span></span>opendaylight-user@root&gt;feature:install odl-restconf odl-l2switch-switch odl-mdsal-apidocs odl-dlux-core
</pre></div>


<p>Now you can login at the container IP with admin as username and
password.</p>
<div class="highlight"><pre><span></span>http://172.17.0.3:8181/index.html
</pre></div>


<p><img alt="Selection_001" src="http://egonzalez.org/wp-content/uploads/2016/06/Selection_001.png"></p>
<p>Best regards</p>
                <div class="clear"></div>

                <div class="info">
                    <a href="https://egonzalez90.github.io/opendaylight-in-a-docker-container.html">posted at 18:26</a>
                    &nbsp;&middot;&nbsp;<a href="https://egonzalez90.github.io/category/linux-various.html" rel="tag">Linux, Various</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://egonzalez90.github.io/tag/-configure.html" class="tags selected">--configure</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/container.html" class="tags">container</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/controller.html" class="tags">controller</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/docker.html" class="tags">docker</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/install.html" class="tags">install</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/opendaylight.html" class="tags">OpenDaylight</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/sdn.html" class="tags">sdn</a>
                </div>
		<a href="https://egonzalez90.github.io/opendaylight-in-a-docker-container.html#disqus_thread">Click to read and post comments</a>
            </article>            <h4 class="date">Feb 24, 2016</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://egonzalez90.github.io/ansible-ini_file-module-simplifying-your-devops-life.html" rel="bookmark" title="Permanent Link to &quot;Ansible ini_file module, simplifying your DevOps life&quot;">Ansible ini_file module, simplifying your DevOps life</a>
                </h2>

                
                

                <p>If you don't read docs, one day you'll realize that your an idiot as i
am|was.</p>
<p>A few days back, I've realized that i was using wrong all Ansible
modules power since i started with it. What happened?</p>
<p>Most of the time i use Ansible is related to OpenStack configuration
jobs. Almost, all OpenStack projects use INI formatted files for their
configuration files.<br>
When i started using Ansible, I searched on Google how to configure any
kind of file with Ansible modules. Almost all blogs/forums that i saw,
talked about lineinfile module. So i used these guidelines on my next
few months, now i realize that i was using in the wrong way Ansible
modules.</p>
<p>Ansible have a module called ini_file, you change values inside INI
formatted files in a easy way , you don't need to use complicated
regular expressions to change a value in a file.</p>
<p>Here you have ini_file module usage docs:
<a href="http://docs.ansible.com/ansible/ini_file_module.html">http://docs.ansible.com/ansible/ini_file_module.html</a></p>
<p>We are going to change Neutron user password in his dump config file, so
we create a simple task on which we can see how ini_file module can be
used.</p>
<div class="highlight"><pre><span></span>- hosts: localhost
  tasks:
  - name: Change neutron user password
    ini_file:
      dest: ~/neutron.conf
      section: keystone_authtoken
      option: password
      value: 12345
</pre></div>


<p>Once the task has been applied, we can see how the values are applied in
a proper ini style.</p>
<div class="highlight"><pre><span></span>cat neutron.conf
[keystone_authtoken]
password = 12345
</pre></div>


<p>How many times you need to make a change in an INI formatted
configuration file with Ansible and used lineinfile module?<br>
If the answer is many times, it's OK, you are a dump like me.</p>
<p>Regards, Eduardo Gonzalez</p>
                <div class="clear"></div>

                <div class="info">
                    <a href="https://egonzalez90.github.io/ansible-ini_file-module-simplifying-your-devops-life.html">posted at 20:00</a>
                    &nbsp;&middot;&nbsp;<a href="https://egonzalez90.github.io/category/linux-various.html" rel="tag">Linux, Various</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://egonzalez90.github.io/tag/-configure.html" class="tags selected">--configure</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/ansible.html" class="tags">ansible</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/config.html" class="tags">config</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/file.html" class="tags">file</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/idiot.html" class="tags">idiot</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/ini.html" class="tags">ini</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/ini_file.html" class="tags">ini_file</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/openstack.html" class="tags">openstack</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/style.html" class="tags">style</a>
                </div>
		<a href="https://egonzalez90.github.io/ansible-ini_file-module-simplifying-your-devops-life.html#disqus_thread">Click to read and post comments</a>
            </article>

                <div class="clear"></div>
                <div class="pages">

                    <a href="https://egonzalez90.github.io/page/2" class="next_page">Next&nbsp;&rarr;</a>
                    <span>Page 1 of 2</span>
                </div>

            <div class="clear"></div>
            <footer>
                <p>
                <a href="https://github.com/jody-frankowski/blue-penguin">Blue Penguin</a> Theme
                &middot;
                Powered by <a href="http://getpelican.com">Pelican</a>
                &middot;
                <a href="https://egonzalez90.github.io/feeds/all.atom.xml" rel="alternate">Atom Feed</a>
            </footer>
        </div>
        <div class="clear"></div>
    </div>
</body>
</html>