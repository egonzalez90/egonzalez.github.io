<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OpenStack Stuff | articles tagged "flavor"</title>
    <link rel="shortcut icon" type="image/png" href="https://egonzalez90.github.io/favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="https://egonzalez90.github.io/favicon.ico">
    <link href="https://egonzalez90.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="OpenStack Stuff Full Atom Feed" />
    <link rel="stylesheet" href="https://egonzalez90.github.io/theme/css/screen.css" type="text/css" />
    <link rel="stylesheet" href="https://egonzalez90.github.io/theme/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="https://egonzalez90.github.io/theme/css/print.css" type="text/css" media="print" />
    <meta name="generator" content="Pelican" />
    <meta name="description" content="" />
    <meta name="author" content="Eduardo Gonzalez" />
</head>
<body>
    <header>
        <nav>
            <ul>
                <li class="ephemeral selected"><a href="https://egonzalez90.github.io/tag/flavor.html">flavor</a></li>
                <li><a href="https://egonzalez90.github.io/">Home</a></li>
                <li><a href="https://docs.openstack.org">OpenStack</a></li>
                <li><a href="https://www.linkedin.com/in/eduardogonzalezgutierrez">Linkedin</a></li>
                <li><a href="https://github.com/egonzalez90">Github</a></li>
                <li><a href="https://egonzalez90.github.io/archives">Archives</a></li>
            </ul>
        </nav>
        <div class="header_box">
            <h1><a href="https://egonzalez90.github.io/">OpenStack Stuff</a></h1>
        </div>
    </header>
    <div id="wrapper">
        <div id="content">            <h4 class="date">Jan 14, 2016</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://egonzalez90.github.io/openstack-segregation-with-availability-zones-and-host-aggregates.html" rel="bookmark" title="Permanent Link to &quot;OpenStack segregation with Availability Zones and Host Aggregates&quot;">OpenStack segregation with Availability Zones and Host Aggregates</a>
                </h2>

                
                

                <p>When a new OpenStack cloud born, usually all servers run over the same
hardware and specifications, often, all servers are in the same
building, room, rack, even a chassis when the cloud is in the first
growth paces.</p>
<p>After a while, workloads increase and the current hardware is not enough
to process that workloads. At this point, your hardware is old and new
hardware is bought. This hardware has different storage disks, CPU, RAM
and so on. You passed from 10's of servers to 100's. DataCenter racks,
rooms and buildings are too small and the growing cloud needs redundancy
between cities or countries.</p>
<p>OpenStack offers a few solutions for that purpose, called Regions,
Cells, Availability Zones and Host Aggregates.<br>
Now, we are going to focus on Availability Zones and Host Aggregates,
which are the way to segregate computational workloads.</p>
<ul>
<li>Host Aggregates:<ul>
<li>Host Aggregates represent a logical set of
    properties/characteristics a group of hosts owns in the form of
    metadata. Imagine some of your servers have SSD disks and the
    other ones SATA, you can map those properties SSD/SATA to a
    group of hosts, when a image or flavor with the metaparameter
    associated is launched, Nova Scheduler will filter the available
    hosts with the meta parameter value and boot the instance on
    hosts with the desired property. Host Aggregates are managed by
    OpenStack admins.</li>
</ul>
</li>
<li>Availability Zones<ul>
<li>Availability Zones represent a logical partition of the
    infrastructure(not necessary but is the common use case) in the
    form of racks, rooms, buildings, etc. Customers can launch
    instances in the desired Availability Zone.</li>
</ul>
</li>
</ul>
<p>Usually, Host Aggregates are mapped to Availability Zones allowing
customers to use the desired set of hardware or characteristics to boot
instances.</p>
<p>At the end of this guide you will know how to:</p>
<ol>
<li>Create Availability Zones and Host Aggregates.</li>
<li>Adding hosts to Host Aggregates and Availability Zones.</li>
<li>Launch instances directly to Availability Zones.</li>
<li>Configure nova scheduler for Host Aggregates usage.</li>
<li>Configure Images and Flavors for scheduling to Host Aggregates.</li>
<li>Launch instances based on flavors and image parameters.</li>
</ol>
<p>Let's start: \00/</p>
<p>Create two Host Aggregate called <code>"az1-ag"/"az2-ag"</code>, this command also,
will create two Availability Zones called <code>"az1"/"az2"</code>.<br>
By default, when a Host Aggregate is created with an Availability Zone,
a metadata key called <code>"availability_zone=NAME_OF_AZ</code>" will be created.</p>
<div class="highlight"><pre><span></span># nova aggregate-create az1-ag az1
+----+--------+-------------------+-------+-------------------------+
| Id | Name   | Availability Zone | Hosts | Metadata                |
+----+--------+-------------------+-------+-------------------------+
| 2  | az1-ag | az1               |       | &#39;availability_zone=az1&#39; |
+----+--------+-------------------+-------+-------------------------+
# nova aggregate-create az2-ag az2
+----+--------+-------------------+-------+-------------------------+
| Id | Name   | Availability Zone | Hosts | Metadata                |
+----+--------+-------------------+-------+-------------------------+
| 3  | az2-ag | az2               |       | &#39;availability_zone=az2&#39; |
+----+--------+-------------------+-------+-------------------------+
</pre></div>


<p>Add one or more compute nodes to Host Aggregates.</p>
<div class="highlight"><pre><span></span># nova aggregate-add-host 2 compute1az
Host compute1az has been successfully added for aggregate 2 
+----+--------+-------------------+--------------+-------------------------+
| Id | Name   | Availability Zone | Hosts        | Metadata                |
+----+--------+-------------------+--------------+-------------------------+
| 2  | az1-ag | az1               | &#39;compute1az&#39; | &#39;availability_zone=az1&#39; |
+----+--------+-------------------+--------------+-------------------------+
# nova aggregate-add-host 3 compute2az
Host compute2az has been successfully added for aggregate 3 
+----+--------+-------------------+--------------+-------------------------+
| Id | Name   | Availability Zone | Hosts        | Metadata                |
+----+--------+-------------------+--------------+-------------------------+
| 3  | az2-ag | az2               | &#39;compute2az&#39; | &#39;availability_zone=az2&#39; |
+----+--------+-------------------+--------------+-------------------------+
</pre></div>


<p>Details about a Host Aggregate can be reviewed with:</p>
<div class="highlight"><pre><span></span># nova aggregate-details az1-ag
+----+--------+-------------------+--------------+-------------------------+
| Id | Name   | Availability Zone | Hosts        | Metadata                |
+----+--------+-------------------+--------------+-------------------------+
| 2  | az1-ag | az1               | &#39;compute1az&#39; | &#39;availability_zone=az1&#39; |
+----+--------+-------------------+--------------+-------------------------+
# nova aggregate-details az2-ag
+----+--------+-------------------+--------------+-------------------------+
| Id | Name   | Availability Zone | Hosts        | Metadata                |
+----+--------+-------------------+--------------+-------------------------+
| 3  | az2-ag | az2               | &#39;compute2az&#39; | &#39;availability_zone=az2&#39; |
+----+--------+-------------------+--------------+-------------------------+
</pre></div>


<p>List Availability Zones and check status.</p>
<div class="highlight"><pre><span></span><span class="c1"># nova availability-zone-list</span>
<span class="s s-Atom">+-----------------------+----------------------------------------+</span>
<span class="p">|</span> <span class="nv">Name</span>                  <span class="p">|</span> <span class="nv">Status</span>                                 <span class="p">|</span>
<span class="s s-Atom">+-----------------------+----------------------------------------+</span>
<span class="p">|</span> <span class="s s-Atom">internal</span>              <span class="p">|</span> <span class="s s-Atom">available</span>                              <span class="p">|</span>
<span class="p">|</span> <span class="p">|</span><span class="o">-</span> <span class="s s-Atom">controlleraz</span>       <span class="p">|</span>                                        <span class="p">|</span>
<span class="p">|</span> <span class="p">|</span> <span class="p">|</span><span class="o">-</span> <span class="s s-Atom">nova</span><span class="o">-</span><span class="s s-Atom">conductor</span>   <span class="p">|</span> <span class="nf">enabled</span> <span class="o">:-</span><span class="p">)</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">14</span><span class="nv">T19</span><span class="s s-Atom">:</span><span class="mi">08</span><span class="s s-Atom">:</span><span class="mf">16.000000</span> <span class="p">|</span>
<span class="p">|</span> <span class="p">|</span> <span class="p">|</span><span class="o">-</span> <span class="s s-Atom">nova</span><span class="o">-</span><span class="s s-Atom">consoleauth</span> <span class="p">|</span> <span class="nf">enabled</span> <span class="o">:-</span><span class="p">)</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">14</span><span class="nv">T19</span><span class="s s-Atom">:</span><span class="mi">08</span><span class="s s-Atom">:</span><span class="mf">16.000000</span> <span class="p">|</span>
<span class="p">|</span> <span class="p">|</span> <span class="p">|</span><span class="o">-</span> <span class="s s-Atom">nova</span><span class="o">-</span><span class="s s-Atom">scheduler</span>   <span class="p">|</span> <span class="nf">enabled</span> <span class="o">:-</span><span class="p">)</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">14</span><span class="nv">T19</span><span class="s s-Atom">:</span><span class="mi">08</span><span class="s s-Atom">:</span><span class="mf">16.000000</span> <span class="p">|</span>
<span class="p">|</span> <span class="p">|</span> <span class="p">|</span><span class="o">-</span> <span class="s s-Atom">nova</span><span class="o">-</span><span class="s s-Atom">cert</span>        <span class="p">|</span> <span class="nf">enabled</span> <span class="o">:-</span><span class="p">)</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">14</span><span class="nv">T19</span><span class="s s-Atom">:</span><span class="mi">08</span><span class="s s-Atom">:</span><span class="mf">13.000000</span> <span class="p">|</span>
<span class="p">|</span> <span class="s s-Atom">az2</span>                   <span class="p">|</span> <span class="s s-Atom">available</span>                              <span class="p">|</span>
<span class="p">|</span> <span class="p">|</span><span class="o">-</span> <span class="s s-Atom">compute2az</span>         <span class="p">|</span>                                        <span class="p">|</span>
<span class="p">|</span> <span class="p">|</span> <span class="p">|</span><span class="o">-</span> <span class="s s-Atom">nova</span><span class="o">-</span><span class="s s-Atom">compute</span>     <span class="p">|</span> <span class="nf">enabled</span> <span class="o">:-</span><span class="p">)</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">14</span><span class="nv">T19</span><span class="s s-Atom">:</span><span class="mi">08</span><span class="s s-Atom">:</span><span class="mf">12.000000</span> <span class="p">|</span>
<span class="p">|</span> <span class="s s-Atom">az1</span>                   <span class="p">|</span> <span class="s s-Atom">available</span>                              <span class="p">|</span>
<span class="p">|</span> <span class="p">|</span><span class="o">-</span> <span class="s s-Atom">compute1az</span>         <span class="p">|</span>                                        <span class="p">|</span>
<span class="p">|</span> <span class="p">|</span> <span class="p">|</span><span class="o">-</span> <span class="s s-Atom">nova</span><span class="o">-</span><span class="s s-Atom">compute</span>     <span class="p">|</span> <span class="nf">enabled</span> <span class="o">:-</span><span class="p">)</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">14</span><span class="nv">T19</span><span class="s s-Atom">:</span><span class="mi">08</span><span class="s s-Atom">:</span><span class="mf">12.000000</span> <span class="p">|</span>
<span class="s s-Atom">+-----------------------+----------------------------------------+</span>
</pre></div>


<p>Other method you can use:</p>
<div class="highlight"><pre><span></span># nova service-list
+----+------------------+--------------+----------+---------+-------+----------------------------+-----------------+
| Id | Binary           | Host         | Zone     | Status  | State | Updated_at                 | Disabled Reason |
+----+------------------+--------------+----------+---------+-------+----------------------------+-----------------+
| 1  | nova-consoleauth | controlleraz | internal | enabled | up    | 2016-01-14T19:54:36.000000 | -               |
| 2  | nova-scheduler   | controlleraz | internal | enabled | up    | 2016-01-14T19:54:36.000000 | -               |
| 3  | nova-conductor   | controlleraz | internal | enabled | up    | 2016-01-14T19:54:35.000000 | -               |
| 4  | nova-cert        | controlleraz | internal | enabled | up    | 2016-01-14T19:54:33.000000 | -               |
| 5  | nova-compute     | compute2az   | az2      | enabled | up    | 2016-01-14T19:54:32.000000 | -               |
| 6  | nova-compute     | compute1az   | az1      | enabled | up    | 2016-01-14T19:54:32.000000 | -               |
+----+------------------+--------------+----------+---------+-------+----------------------------+-----------------+
</pre></div>


<p>Launch two instances using <code>"--availability-zone AZ</code>" option, you can
even select the compute node to use, just use
<code>"--availability-zone AZ:COMPUTE_NODE</code>".</p>
<div class="highlight"><pre><span></span># nova boot --flavor m1.tiny --image cirros --nic net-id=6d62149e-74d3-4e52-9813-53ad207309f4 --availability-zone az1 instanceaz1
# nova boot --flavor m1.tiny --image cirros --nic net-id=6d62149e-74d3-4e52-9813-53ad207309f4 --availability-zone az2 instanceaz2
</pre></div>


<p>Ensure the instances are running in the desired Availability Zone.</p>
<div class="highlight"><pre><span></span># nova show instanceaz1 | grep OS-EXT-AZ | awk &#39;{print$2&quot;:&quot;$4}&#39;
OS-EXT-AZ:availability_zone:az1
# nova show instanceaz2 | grep OS-EXT-AZ | awk &#39;{print$2&quot;:&quot;$4}&#39;
OS-EXT-AZ:availability_zone:az2
</pre></div>


<p>List Glance images.</p>
<div class="highlight"><pre><span></span># glance image-list
+--------------------------------------+----------+
| ID                                   | Name     |
+--------------------------------------+----------+
| a6d7a606-f725-480a-9b1b-7b3ae39b93d4 | cirros   |
| a6540d72-dff7-4fb1-bc64-a8ea69e65178 | imageaz1 |
| 9c7e2d55-0b96-43e2-9231-88e426edb350 | imageaz2 |
+--------------------------------------+----------+
</pre></div>


<p>Update the images with custom properties, i use <code>"availability_zone"</code>
because is the default meta parameter a Host Aggregate owns when is
inside Availability Zones.</p>
<div class="highlight"><pre><span></span># glance image-update --property availability_zone=az1 a6540d72-dff7-4fb1-bc64-a8ea69e65178
+-------------------+--------------------------------------+
| Property          | Value                                |
+-------------------+--------------------------------------+
| availability_zone | az1                                  |
| checksum          | 133eae9fb1c98f45894a4e60d8736619     |
| container_format  | bare                                 |
| created_at        | 2016-01-14T19:59:04Z                 |
| disk_format       | qcow2                                |
| id                | a6540d72-dff7-4fb1-bc64-a8ea69e65178 |
| min_disk          | 0                                    |
| min_ram           | 0                                    |
| name              | imageaz1                             |
| owner             | 0571c6769c3f46acb195eeb01b87ae38     |
| protected         | False                                |
| size              | 13200896                             |
| status            | active                               |
| tags              | []                                   |
| updated_at        | 2016-01-14T20:13:05Z                 |
| virtual_size      | None                                 |
| visibility        | private                              |
+-------------------+--------------------------------------+
# glance image-update --property availability_zone=az2 9c7e2d55-0b96-43e2-9231-88e426edb350
+-------------------+--------------------------------------+
| Property          | Value                                |
+-------------------+--------------------------------------+
| availability_zone | az2                                  |
| checksum          | 133eae9fb1c98f45894a4e60d8736619     |
| container_format  | bare                                 |
| created_at        | 2016-01-14T19:59:10Z                 |
| disk_format       | qcow2                                |
| id                | 9c7e2d55-0b96-43e2-9231-88e426edb350 |
| min_disk          | 0                                    |
| min_ram           | 0                                    |
| name              | imageaz2                             |
| owner             | 0571c6769c3f46acb195eeb01b87ae38     |
| protected         | False                                |
| size              | 13200896                             |
| status            | active                               |
| tags              | []                                   |
| updated_at        | 2016-01-14T20:13:27Z                 |
| virtual_size      | None                                 |
| visibility        | private                              |
+-------------------+--------------------------------------+
</pre></div>


<p>Boot two instances, now we use images with custom properties, those
properties will map to Availability Zones(you can use other type of
parameters mapping to Host Aggregates characteristics).</p>
<div class="highlight"><pre><span></span># nova boot --flavor m1.tiny --image imageaz1 --nic net-id=6d62149e-74d3-4e52-9813-53ad207309f4 instanceimageaz1
# nova boot --flavor m1.tiny --image imageaz2 --nic net-id=6d62149e-74d3-4e52-9813-53ad207309f4 instanceimageaz2
</pre></div>


<p>Ensure the instances booted in the desired Availability Zone.</p>
<div class="highlight"><pre><span></span># nova show instanceimageaz1 | grep OS-EXT-AZ | awk &#39;{print$2&quot;:&quot;$4}&#39;
OS-EXT-AZ:availability_zone:az1
# nova show instanceimageaz2 | grep OS-EXT-AZ | awk &#39;{print$2&quot;:&quot;$4}&#39;
OS-EXT-AZ:availability_zone:az2
</pre></div>


<p>Other method to launch instances is with parameters in flavors.<br>
Create two flavors.</p>
<div class="highlight"><pre><span></span># nova flavor-create --is-public true flavoraz1 6 512 1 1
+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+
| ID | Name      | Memory_MB | Disk | Ephemeral | Swap | VCPUs | RXTX_Factor | Is_Public |
+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+
| 7  | flavoraz1 | 512       | 1    | 0         |      | 1     | 1.0         | True      |
+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+
# nova flavor-create --is-public true flavoraz2 7 512 1 1
+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+
| ID | Name      | Memory_MB | Disk | Ephemeral | Swap | VCPUs | RXTX_Factor | Is_Public |
+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+
| 8  | flavoraz2 | 512       | 1    | 0         |      | 1     | 1.0         | True      |
+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+
</pre></div>


<p>Add metadata to a Host Aggregate with some characteristic property as
can be fast HD or cheap HW.</p>
<div class="highlight"><pre><span></span># nova aggregate-set-metadata az1-ag fast=true
Metadata has been successfully updated for aggregate 2.
+----+--------+-------------------+--------------+--------------------------------------+
| Id | Name   | Availability Zone | Hosts        | Metadata                             |
+----+--------+-------------------+--------------+--------------------------------------+
| 2  | az1-ag | az1               | &#39;compute1az&#39; | &#39;availability_zone=az1&#39;, &#39;fast=true&#39; |
+----+--------+-------------------+--------------+--------------------------------------+
# nova aggregate-set-metadata az2-ag cheap=true
Metadata has been successfully updated for aggregate 3.
+----+--------+-------------------+--------------+---------------------------------------+
| Id | Name   | Availability Zone | Hosts        | Metadata                              |
+----+--------+-------------------+--------------+---------------------------------------+
| 3  | az2-ag | az2               | &#39;compute2az&#39; | &#39;availability_zone=az2&#39;, &#39;cheap=true&#39; |
+----+--------+-------------------+--------------+---------------------------------------+
</pre></div>


<p>Update the previous created flavors with the associated metadata key
with the Host Aggregate.</p>
<div class="highlight"><pre><span></span># nova flavor-key flavoraz1 set  aggregate_instance_extra_specs:fast=true
# nova flavor-key flavoraz2 set  aggregate_instance_extra_specs:cheap=true
</pre></div>


<p>Ensure, the properties are properly created.</p>
<div class="highlight"><pre><span></span># nova flavor-show 7 | grep fast | awk &#39;{print$4$5}&#39;
{&quot;aggregate_instance_extra_specs:fast&quot;:&quot;true&quot;}
# nova flavor-show 8 | grep cheap | awk &#39;{print$4$5}&#39;
{&quot;aggregate_instance_extra_specs:cheap&quot;:&quot;true&quot;}
</pre></div>


<p>By default, Nova Scheduler don't allow filtering by extra Specs inserted
in flavors or images.<br>
First, ensure the following scheduler filters are allowed in Control
nodes.</p>
<div class="highlight"><pre><span></span># egrep ^scheduler_default_filters /etc/nova/nova.conf 
scheduler_default_filters=AggregateInstanceExtraSpecsFilter,RetryFilter,AvailabilityZoneFilter,RamFilter,ComputeFilter,ComputeCapabilitiesFilter,ImagePropertiesFilter,ServerGroupAntiAffinityFilter,ServerGroupAffinityFilter
</pre></div>


<p>If a change has been done in nova.conf file, restart nova services</p>
<div class="highlight"><pre><span></span># openstack-service restart nova
</pre></div>


<p>Boot another two instaces, now using custom flavors</p>
<div class="highlight"><pre><span></span># nova boot --flavor flavoraz1 --image cirros --nic net-id=6d62149e-74d3-4e52-9813-53ad207309f4 instanceflavoraz1
# nova boot --flavor flavoraz2 --image cirros --nic net-id=6d62149e-74d3-4e52-9813-53ad207309f4 instanceflavoraz2
</pre></div>


<p>Check where the instances are running.</p>
<div class="highlight"><pre><span></span># nova show instanceflavoraz1 | grep OS-EXT-AZ | awk &#39;{print$2&quot;:&quot;$4}&#39;
OS-EXT-AZ:availability_zone:az1
# nova show instanceflavoraz2 | grep OS-EXT-AZ | awk &#39;{print$2&quot;:&quot;$4}&#39;
OS-EXT-AZ:availability_zone:az2
</pre></div>


<p>That's all for now<br>
Hope this guide helps.<br>
Regards</p>
                <div class="clear"></div>

                <div class="info">
                    <a href="https://egonzalez90.github.io/openstack-segregation-with-availability-zones-and-host-aggregates.html">posted at 21:34</a>
                    &nbsp;&middot;&nbsp;<a href="https://egonzalez90.github.io/category/openstack.html" rel="tag">OpenStack</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://egonzalez90.github.io/tag/availability-zones.html" class="tags">availability zones</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/flavor.html" class="tags selected">flavor</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/guide.html" class="tags">guide</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/host-aggregates.html" class="tags">host aggregates</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/image.html" class="tags">image</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/meta.html" class="tags">meta</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/nova.html" class="tags">nova</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/openstack.html" class="tags">openstack</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/scheduler.html" class="tags">scheduler</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/segregation.html" class="tags">segregation</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/usage.html" class="tags">usage</a>
                </div>
		<a href="https://egonzalez90.github.io/openstack-segregation-with-availability-zones-and-host-aggregates.html#disqus_thread">Click to read and post comments</a>
            </article>            <h4 class="date">Oct 05, 2014</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://egonzalez90.github.io/nova-flavor-con-acls.html" rel="bookmark" title="Permanent Link to &quot;Nova flavor con control de acceso&quot;">Nova flavor con control de acceso</a>
                </h2>

                
                

                <p>Primero crearemos un "flavor"(sabor) mediante es siguiente comando, este
sabor le haremos privado mediante la opción --is-public=False, un ID
23, con 4vCPU y 4 GB de RAM.<!--more--></p>
<p>``` {style="border: 0px; margin-top: 0px; margin-bottom: 24px; padding: 1.5em; vertical-align: baseline; font-family: 'Courier 10 Pitch', Courier, monospace; color: #222222; line-height: 21px; overflow: auto; font-size: 15px; background: #f7f7f7;"}
$ nova flavor-create 4vCPU-4GB_Mem 23 4096 0 4 --is-public=False
+----+----------------+-----------+------+-----------+------+-------+-------------+-----------+
| ID | Name           | Memory_MB | Disk | Ephemeral | Swap | VCPUs | RXTX_Factor | Is_Public |
+----+----------------+-----------+------+-----------+------+-------+-------------+-----------+
| 23 | 4vCPU-4GB_Mem  |  4096     | 0    | 0         |      |     4 | 1.0         |     False |
+----+----------------+-----------+------+-----------+------+-------+-------------+-----------+</p>
<div class="highlight"><pre><span></span><span class="nt">A</span> <span class="nt">continuaci</span><span class="err">ó</span><span class="nt">n</span> <span class="nt">buscaremos</span> <span class="nt">el</span> <span class="nt">tenant</span><span class="err">\</span><span class="nt">_ID</span><span class="err"> </span><span class="nt">del</span> <span class="nt">tenant</span> <span class="nt">al</span> <span class="nt">que</span> <span class="nt">queramos</span>
<span class="nt">asignar</span> <span class="nt">el</span> <span class="nt">sabor</span><span class="o">,</span> <span class="nt">en</span> <span class="nt">este</span> <span class="nt">caso</span> <span class="nt">el</span> <span class="nt">tenant</span><span class="o">(</span><span class="nt">previamente</span> <span class="nt">creado</span><span class="o">)</span> <span class="nt">es</span> <span class="nt">prueba</span>

<span class="err">```</span> <span class="p">{</span><span class="err">style=&quot;</span><span class="k">border</span><span class="p">:</span> <span class="mi">0</span><span class="kt">px</span><span class="p">;</span> <span class="k">margin-top</span><span class="p">:</span> <span class="mi">0</span><span class="kt">px</span><span class="p">;</span> <span class="k">margin-bottom</span><span class="p">:</span> <span class="mi">24</span><span class="kt">px</span><span class="p">;</span> <span class="k">padding</span><span class="p">:</span> <span class="mf">1.5</span><span class="kt">em</span><span class="p">;</span> <span class="k">vertical-align</span><span class="p">:</span> <span class="kc">baseline</span><span class="p">;</span> <span class="k">font-family</span><span class="p">:</span> <span class="s1">&#39;Courier 10 Pitch&#39;</span><span class="p">,</span> <span class="n">Courier</span><span class="p">,</span> <span class="kc">monospace</span><span class="p">;</span> <span class="k">color</span><span class="p">:</span> <span class="mh">#222222</span><span class="p">;</span> <span class="k">line-height</span><span class="p">:</span> <span class="mi">21</span><span class="kt">px</span><span class="p">;</span> <span class="k">overflow</span><span class="p">:</span> <span class="kc">auto</span><span class="p">;</span> <span class="k">font-size</span><span class="p">:</span> <span class="mi">15</span><span class="kt">px</span><span class="p">;</span> <span class="k">background</span><span class="p">:</span> <span class="mh">#f7f7f7</span><span class="p">;</span><span class="err">&quot;</span><span class="p">}</span>
<span class="o">$</span> <span class="nt">keystone</span> <span class="nt">tenant-list</span> <span class="o">|</span> <span class="nt">grep</span> <span class="nt">prueba</span>
<span class="o">|</span> <span class="nt">41a0db24bc8940b6a2f3297bef5f6cee</span> <span class="o">|</span> <span class="nt">prueba</span> <span class="o">|</span> <span class="nt">True</span> <span class="o">|</span>
</pre></div>


<p>Con el tenant_ID y el flavor_ID, asignaremos el flavor a el tenant, lo
haremos mediante el siguiente comando:</p>
<ul>
<li>23 es flavor_ID</li>
<li>41a0db24bc8940b6a2f3297bef5f6cee es tenant_ID</li>
</ul>
<p>``` {style="border: 0px; margin-top: 0px; margin-bottom: 24px; padding: 1.5em; vertical-align: baseline; font-family: 'Courier 10 Pitch', Courier, monospace; color: #222222; line-height: 21px; overflow: auto; font-size: 15px; background: #f7f7f7;"}
$ nova flavor-access-add 23 41a0db24bc8940b6a2f3297bef5f6cee
+-----------+----------------------------------+
| Flavor_ID | Tenant_ID                        |
+-----------+----------------------------------+
|        23 | 41a0db24bc8940b6a2f3297bef5f6cee |
+-----------+----------------------------------+</p>
<div class="highlight"><pre><span></span><span class="nt">Por</span> <span class="nt">ultimo</span> <span class="nt">comprobaremos</span><span class="err"> </span><span class="nt">la</span> <span class="nt">lista</span> <span class="nt">de</span> <span class="nt">sabores</span><span class="o">,</span> <span class="nt">aqui</span> <span class="nt">veremos</span> <span class="nt">como</span> <span class="nt">el</span>
<span class="nt">flavor</span> <span class="nt">no</span> <span class="nt">es</span> <span class="nt">publico</span><span class="o">,</span> <span class="err"> </span><span class="nt">y</span> <span class="nt">deber</span><span class="err">í</span><span class="nt">a</span> <span class="nt">de</span> <span class="nt">estar</span> <span class="nt">solo</span> <span class="nt">disponible</span> <span class="nt">para</span> <span class="nt">el</span> <span class="nt">tenant</span>
<span class="nt">asignado</span> <span class="nt">anteriormente</span>

<span class="err">```</span> <span class="p">{</span><span class="err">style=&quot;</span><span class="k">border</span><span class="p">:</span> <span class="mi">0</span><span class="kt">px</span><span class="p">;</span> <span class="k">margin-top</span><span class="p">:</span> <span class="mi">0</span><span class="kt">px</span><span class="p">;</span> <span class="k">margin-bottom</span><span class="p">:</span> <span class="mi">24</span><span class="kt">px</span><span class="p">;</span> <span class="k">padding</span><span class="p">:</span> <span class="mf">1.5</span><span class="kt">em</span><span class="p">;</span> <span class="k">vertical-align</span><span class="p">:</span> <span class="kc">baseline</span><span class="p">;</span> <span class="k">font-family</span><span class="p">:</span> <span class="s1">&#39;Courier 10 Pitch&#39;</span><span class="p">,</span> <span class="n">Courier</span><span class="p">,</span> <span class="kc">monospace</span><span class="p">;</span> <span class="k">color</span><span class="p">:</span> <span class="mh">#222222</span><span class="p">;</span> <span class="k">line-height</span><span class="p">:</span> <span class="mi">21</span><span class="kt">px</span><span class="p">;</span> <span class="k">overflow</span><span class="p">:</span> <span class="kc">auto</span><span class="p">;</span> <span class="k">font-size</span><span class="p">:</span> <span class="mi">15</span><span class="kt">px</span><span class="p">;</span> <span class="k">background</span><span class="p">:</span> <span class="mh">#f7f7f7</span><span class="p">;</span><span class="err">&quot;</span><span class="p">}</span>
<span class="o">$</span> <span class="nt">nova</span> <span class="nt">flavor-list</span>
<span class="o">+</span><span class="nt">----</span><span class="o">+</span><span class="nt">-----------------</span><span class="o">+</span><span class="nt">-----------</span><span class="o">+</span><span class="nt">------</span><span class="o">+</span><span class="nt">-----------</span><span class="o">+</span><span class="nt">------</span><span class="o">+</span><span class="nt">-------</span><span class="o">+</span><span class="nt">-------------</span><span class="o">+</span><span class="nt">-----------</span><span class="o">+</span>
<span class="o">|</span> <span class="nt">ID</span> <span class="o">|</span> <span class="nt">Name</span>            <span class="o">|</span> <span class="nt">Memory_MB</span> <span class="o">|</span> <span class="nt">Disk</span> <span class="o">|</span> <span class="nt">Ephemeral</span> <span class="o">|</span> <span class="nt">Swap</span> <span class="o">|</span> <span class="nt">VCPUs</span> <span class="o">|</span> <span class="nt">RXTX_Factor</span> <span class="o">|</span> <span class="nt">Is_Public</span> <span class="o">|</span>
<span class="o">+</span><span class="nt">----</span><span class="o">+</span><span class="nt">-----------------</span><span class="o">+</span><span class="nt">-----------</span><span class="o">+</span><span class="nt">------</span><span class="o">+</span><span class="nt">-----------</span><span class="o">+</span><span class="nt">------</span><span class="o">+</span><span class="nt">-------</span><span class="o">+</span><span class="nt">-------------</span><span class="o">+</span><span class="nt">-----------</span><span class="o">+</span>
<span class="o">|</span> <span class="nt">23</span> <span class="o">|</span> <span class="nt">4vCPU-4GB_Mem</span>   <span class="o">|</span> <span class="nt">4096</span>      <span class="o">|</span> <span class="nt">0</span>    <span class="o">|</span> <span class="nt">0</span>         <span class="o">|</span>      <span class="o">|</span> <span class="nt">4</span>     <span class="o">|</span> <span class="nt">4</span><span class="p">.</span><span class="nc">0</span>         <span class="o">|</span> <span class="nt">False</span>     <span class="o">|</span>
<span class="o">+</span><span class="nt">----</span><span class="o">+</span><span class="nt">-----------------</span><span class="o">+</span><span class="nt">-----------</span><span class="o">+</span><span class="nt">------</span><span class="o">+</span><span class="nt">-----------</span><span class="o">+</span><span class="nt">------</span><span class="o">+</span><span class="nt">-------</span><span class="o">+</span><span class="nt">-------------</span><span class="o">+</span><span class="nt">-----------</span><span class="o">+</span>
</pre></div>


<p><span style="font-size: 14px; line-height: 22.3999996185303px;">La
información sacada para este post viene de este blog (en ingles),
visitarle si tenéis
ocasión: <a href="http://blog.aaronorosen.com/nova-flavors-with-access-control/">http://blog.aaronorosen.com/nova-flavors-with-access-control/</a></span></p>
                <div class="clear"></div>

                <div class="info">
                    <a href="https://egonzalez90.github.io/nova-flavor-con-acls.html">posted at 17:47</a>
                    &nbsp;&middot;&nbsp;<a href="https://egonzalez90.github.io/category/openstack.html" rel="tag">OpenStack</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://egonzalez90.github.io/tag/acceso.html" class="tags">acceso</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/acl.html" class="tags">acl</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/cloud.html" class="tags">cloud</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/control.html" class="tags">control</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/flavor.html" class="tags selected">flavor</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/flavor_id.html" class="tags">flavor_id</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/flavor-access-add.html" class="tags">flavor-access-add</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/flavor-create.html" class="tags">flavor-create</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/list.html" class="tags">list</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/nova.html" class="tags">nova</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/openstack.html" class="tags">openstack</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/tenant_id.html" class="tags">tenant_id</a>
                </div>
		<a href="https://egonzalez90.github.io/nova-flavor-con-acls.html#disqus_thread">Click to read and post comments</a>
            </article>

            <div class="clear"></div>
            <footer>
                <p>
                <a href="https://github.com/jody-frankowski/blue-penguin">Blue Penguin</a> Theme
                &middot;
                Powered by <a href="http://getpelican.com">Pelican</a>
                &middot;
                <a href="https://egonzalez90.github.io/feeds/all.atom.xml" rel="alternate">Atom Feed</a>
            </footer>
        </div>
        <div class="clear"></div>
    </div>
</body>
</html>