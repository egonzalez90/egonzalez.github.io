<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OpenStack Stuff | articles in the "Various" category</title>
    <link rel="shortcut icon" type="image/png" href="https://egonzalez90.github.io/favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="https://egonzalez90.github.io/favicon.ico">
    <link href="https://egonzalez90.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="OpenStack Stuff Full Atom Feed" />
    <link href="https://egonzalez90.github.io/feeds/various.atom.xml" type="application/atom+xml" rel="alternate" title="OpenStack Stuff Categories Atom Feed" />
    <link rel="stylesheet" href="https://egonzalez90.github.io/theme/css/screen.css" type="text/css" />
    <link rel="stylesheet" href="https://egonzalez90.github.io/theme/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="https://egonzalez90.github.io/theme/css/print.css" type="text/css" media="print" />
    <meta name="generator" content="Pelican" />
    <meta name="description" content="" />
    <meta name="author" content="Eduardo Gonzalez" />
</head>
<body>
    <header>
        <nav>
            <ul>

                <li class="ephemeral selected"><a href="https://egonzalez90.github.io/category/various.html">Various</a></li>
                <li><a href="https://egonzalez90.github.io/">Home</a></li>
                <li><a href="https://docs.openstack.org">OpenStack</a></li>
                <li><a href="https://www.linkedin.com/in/eduardogonzalezgutierrez">Linkedin</a></li>
                <li><a href="https://github.com/egonzalez90">Github</a></li>
                <li><a href="https://egonzalez90.github.io/archives">Archives</a></li>
            </ul>
        </nav>
        <div class="header_box">
            <h1><a href="https://egonzalez90.github.io/">OpenStack Stuff</a></h1>
        </div>
    </header>
    <div id="wrapper">
        <div id="content">            <h4 class="date">Oct 31, 2016</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://egonzalez90.github.io/to-conditional-or-to-skip-that-is-the-ansible-question.html" rel="bookmark" title="Permanent Link to &quot;To Conditional or To Skip, that is the Ansible question&quot;">To Conditional or To Skip, that is the Ansible question</a>
                </h2>

                
                

                <p>Have you ever think about if an Ansible task should be skipped with a
conditional or without (hidden skip)?.<br>
Well, this post will analyse both methods.</p>
<p>Let's use a example to create the same result and analyse the both
methods:</p>
<p>In OpenStack Kolla we found that sometimes operators need to customise
policy.json files. That's fine, but the problem is that policy.json
files are installed with the services by default and we don't need/want
to maintain policy.json files in our repository because for sure will
cause bugs from outdated policy files in the future.</p>
<p>What's the proposed solution to this? Allow operators use their own
policy files only when their files exists in a custom configuration
folder. If custom files are not present, default policy.json files are
already present as part of the software installation. ( Actually this
change is under review )</p>
<h2>To Conditional method</h2>
<p>Code snippet:</p>
<div class="highlight"><pre><span></span><span class="x">  - name: Check if file exists</span>
<span class="x">    stat:</span>
<span class="x">      path: &quot;/tmp/custom_file.json&quot;</span>
<span class="x">    register: check_custom_file_exist</span>

<span class="x">  - name: Copy custom policy when exist</span>
<span class="x">    template:</span>
<span class="x">      src: &quot;/tmp/custom_file.json&quot;</span>
<span class="x">      dest: &quot;/tmp/destination_file.json&quot;</span>
<span class="x">    when: &quot;</span><span class="cp">{{</span> <span class="nv">check_custom_file_exist.stat.exists</span> <span class="cp">}}</span><span class="x">&quot;</span>
</pre></div>


<p>The first task checks if the file is present and register the stat
result.<br>
The second task, copy the file only when the registered result of the
previous task is True. (exists == True)</p>
<p>Outputs the following when the file is not present:</p>
<div class="highlight"><pre><span></span>PLAY [localhost] ***************************************************************

TASK [Check if file exists] ****************************************************
ok: [localhost]

TASK [Copy custom policy when exist] *******************************************
skipping: [localhost]

PLAY RECAP *********************************************************************
localhost                  : ok=1    changed=0    unreachable=0    failed=0
</pre></div>


<p>We can see the copy file task is skipped with a skipping message.</p>
<h2>To Skip method</h2>
<p>Code snippet:</p>
<div class="highlight"><pre><span></span><span class="x">  - name: Copy custom policy when exist</span>
<span class="x">    template:</span>
<span class="x">      src: &quot;</span><span class="cp">{{</span> <span class="nv">item</span> <span class="cp">}}</span><span class="x">&quot;</span>
<span class="x">      dest: &quot;/tmp/destination_file.json&quot;</span>
<span class="x">    with_first_found:</span>
<span class="x">    - files:</span>
<span class="x">      - custom_file.json</span>
<span class="x">      skip: True</span>
</pre></div>


<p>This playbook contains a single task, this task will use the first found
file in a list of files. If no file is present will skip the task.</p>
<p>Output from this execution:</p>
<div class="highlight"><pre><span></span>PLAY [localhost] ***************************************************************

TASK [Copy custom policy when exist] *******************************************

PLAY RECAP *********************************************************************
localhost                  : ok=0    changed=0    unreachable=0    failed=0
</pre></div>


<p>We can see that no task is executed when custom files are not present,
no output from the task (hidden skip).</p>
<h2>Analysis and own opinion</h2>
<p>Both methods do the same, both copy custom files when are present and
both skip copy task when are not present.<br>
What are the differences between both methods?</p>
<p>To_skip method is simpler to read and unified in a single task,
to_conditional is created within two tasks.<br>
To_conditional method takes longer to be executed as it has to check
the existence of a file and then evaluate a conditional.</p>
<p>You may think that to_skip method is better than to_conditional
method, that's right in terms of code syntax and execution times.
But...<br>
As both, operator and infrastructure developer, I always use
to_conditional method because when I'm deploying something new, I want
to know what is executed and what not. In to_skip method you don't know
because there is no output provided from the task(not really true) but
in to_conditional method it clearly says Skipping.</p>
<p>Execution times are not a problem in most use cases, as is not commonly
used this kind of tasks in CM systems, only a few tasks will need this
type of logic.</p>
<p>Regards, Eduardo Gonzalez</p>
                <div class="clear"></div>

                <div class="info">
                    <a href="https://egonzalez90.github.io/to-conditional-or-to-skip-that-is-the-ansible-question.html">posted at 20:49</a>
                    &nbsp;&middot;&nbsp;<a href="https://egonzalez90.github.io/category/various.html" rel="tag">Various</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://egonzalez90.github.io/tag/analysis.html" class="tags">analysis</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/ansible.html" class="tags">ansible</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/code.html" class="tags">code</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/conditional.html" class="tags">conditional</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/logic.html" class="tags">logic</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/opinion.html" class="tags">opinion</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/skip.html" class="tags">skip</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/syntax.html" class="tags">syntax</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/true.html" class="tags">True</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/when.html" class="tags">when</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/with_first_found.html" class="tags">with_first_found</a>
                </div>
		<a href="https://egonzalez90.github.io/to-conditional-or-to-skip-that-is-the-ansible-question.html#disqus_thread">Click to read and post comments</a>
            </article>            <h4 class="date">Sep 19, 2014</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://egonzalez90.github.io/netstat-aplicaciones-con-conexion-a-internet.html" rel="bookmark" title="Permanent Link to &quot;NETSTAT aplicaciones con conexión a Internet&quot;">NETSTAT aplicaciones con conexión a Internet</a>
                </h2>

                
                

                <p>Mediante el comando netstat y alguna de sus opciones podremos analizar
las conexiones de red, para ver las conexiones que establecen las
aplicaciones utilizaremos estas:</p>
<blockquote>
<p>netstat -bo 10</p>
</blockquote>
<p>o</p>
<blockquote>
<p>netstat -b</p>
</blockquote>
                <div class="clear"></div>

                <div class="info">
                    <a href="https://egonzalez90.github.io/netstat-aplicaciones-con-conexion-a-internet.html">posted at 13:47</a>
                    &nbsp;&middot;&nbsp;<a href="https://egonzalez90.github.io/category/various.html" rel="tag">Various</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://egonzalez90.github.io/tag/-bo.html" class="tags">-bo</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/exe.html" class="tags">.exe</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/10.html" class="tags">10</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/aplicaciones.html" class="tags">aplicaciones</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/conexion.html" class="tags">conexion</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/direccion.html" class="tags">dirección</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/ip.html" class="tags">IP</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/netstat.html" class="tags">netstat</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/url.html" class="tags">url</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/windows.html" class="tags">windows</a>
                </div>
		<a href="https://egonzalez90.github.io/netstat-aplicaciones-con-conexion-a-internet.html#disqus_thread">Click to read and post comments</a>
            </article>            <h4 class="date">Aug 26, 2014</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://egonzalez90.github.io/leer-manga-en-amazon-kindle.html" rel="bookmark" title="Permanent Link to &quot;Leer manga en Amazon Kindle&quot;">Leer manga en Amazon Kindle</a>
                </h2>

                
                

                <p>Muchos de los que tenemos un kindle somos fieles lectores de manga y
comics, seguro que a ninguno nos gusta leer los pdf o las imágenes
sueltas. Para poder crear los archivos en formato de kindle .MOBI,
utilizaremos estos programas:</p>
<p>Kindle Comic Converter: http://kcc.iosphe.re/</p>
<p>Kindlegen.exe: híamos todo configurado para podre formatear imágenes,
carpetas, zip, rar, pdf, etc a los formatos MOBI, EPUB, CBZ.</p>
<p><a href="http://vps38574.vps.ovh.ca/wp-content/uploads/2014/08/kkc.png"><img alt="kkc" src="http://vps38574.vps.ovh.ca/wp-content/uploads/2014/08/kkc.png"></a></p>
<p>Para crear nuestros archivos en uno de los 3 formatos disponibles,
primero seleccionaremos nuestro dispositivo Kindle en el desplegable,
después añadiremos un archivo o carpeta mediante Add file o Add
directory.</p>
<p>A continuación utilizaremos alguna de las opciones disponibles. Yo
personalmente solo utilizo High/Ultra quality, las demás opciones no me
gustan, pero eso es para gustos.</p>
<p>Ahora ya solo deberéis probar las diferentes combinaciones de las
opciones hasta que encontréis las que mas os gusten. Y ya solo queda
disfrutar de los mangas o comics en vuestros kindle.</p>
<p>PD: Si os gusta la obra de algún autor siempre es preferible comprarla y
apoyar económicamente en la producción de dicha obra.</p>
<p>Un saludo</p>
                <div class="clear"></div>

                <div class="info">
                    <a href="https://egonzalez90.github.io/leer-manga-en-amazon-kindle.html">posted at 17:15</a>
                    &nbsp;&middot;&nbsp;<a href="https://egonzalez90.github.io/category/various.html" rel="tag">Various</a>
                    &nbsp;&middot;
                    &nbsp;<a href="https://egonzalez90.github.io/tag/amazon.html" class="tags">amazon</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/comic.html" class="tags">comic</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/converter.html" class="tags">converter</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/jpg.html" class="tags">jpg</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/kindle.html" class="tags">kindle</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/kindle-comic-converter.html" class="tags">kindle comic converter</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/kindlegen.html" class="tags">kindlegen</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/leer.html" class="tags">leer</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/manga.html" class="tags">manga</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/mobi.html" class="tags">mobi</a>
                    &nbsp;<a href="https://egonzalez90.github.io/tag/pdf.html" class="tags">pdf</a>
                </div>
		<a href="https://egonzalez90.github.io/leer-manga-en-amazon-kindle.html#disqus_thread">Click to read and post comments</a>
            </article>

                <div class="clear"></div>
                <div class="pages">

                    <a href="https://egonzalez90.github.io/page/2" class="next_page">Next&nbsp;&rarr;</a>
                    <span>Page 1 of 2</span>
                </div>

            <div class="clear"></div>
            <footer>
                <p>
                <a href="https://github.com/jody-frankowski/blue-penguin">Blue Penguin</a> Theme
                &middot;
                Powered by <a href="http://getpelican.com">Pelican</a>
                &middot;
                <a href="https://egonzalez90.github.io/feeds/all.atom.xml" rel="alternate">Atom Feed</a>
            </footer>
        </div>
        <div class="clear"></div>
    </div>
</body>
</html>