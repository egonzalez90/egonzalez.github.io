<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>OpenStack Stuff - Linux, Various</title><link href="https://egonzalez90.github.io/" rel="alternate"></link><link href="https://egonzalez90.github.io/feeds/linux-various.atom.xml" rel="self"></link><id>https://egonzalez90.github.io/</id><updated>2016-07-12T20:57:00+02:00</updated><entry><title>Spacewalk (Red Hat Satellite v5) in a Docker container PoC</title><link href="https://egonzalez90.github.io/spacewalk-red-hat-satellite-v5-in-a-docker-container-poc.html" rel="alternate"></link><published>2016-07-12T20:57:00+02:00</published><updated>2016-07-12T20:57:00+02:00</updated><author><name>egongu90</name></author><id>tag:egonzalez90.github.io,2016-07-12:/spacewalk-red-hat-satellite-v5-in-a-docker-container-poc.html</id><summary type="html">&lt;p&gt;Spacewalk was the upstream project to provide a Linux systems management
layer on which Red Hat Satellite was based, was based at least until RH
Satellite version 5. Newer versions are not anymore based on Spacewalk,
instead Satellite is a federation of several upstream open source
projects, including Katello, Foreman …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Spacewalk was the upstream project to provide a Linux systems management
layer on which Red Hat Satellite was based, was based at least until RH
Satellite version 5. Newer versions are not anymore based on Spacewalk,
instead Satellite is a federation of several upstream open source
projects, including Katello, Foreman, Pulp, and Candlepin.&lt;/p&gt;
&lt;p&gt;Some weeks ago, a friend asked me if I knew a Docker container image for
Satellite.&lt;br&gt;
I have not found any image. What I found was some Spacewalk images, but
sadly none of them worked for me.&lt;br&gt;
I decided to create an image for this purpose.&lt;/p&gt;
&lt;p&gt;While developing the image, I found serious troubles to make it run with
systemd (I'm a fan of systemd, but not inside containers yet).&lt;br&gt;
The result was a semi functional working image. I said semi functional
because some Spacewalk features are not working (probably an issue with
systemd again).&lt;br&gt;
The main problem was that spacewalk-setup script starts and uses
systemd to configure the database and the other needed services, that's
OK in a VM but not in a container.&lt;br&gt;
So i needed to hack into postgres setup and start the services with the
typical &lt;code&gt;command --config-file file.conf&lt;/code&gt; executed from supervisord as
Docker entrypoint.&lt;br&gt;
Currently there is an issue with &lt;code&gt;osa-dispatcher&lt;/code&gt;, on which I can't
find a fix to make it run.&lt;/p&gt;
&lt;p&gt;This image is primarily created just for test Spacewalk interface and be
more comfortable with it aka testing/development purposes, or just to
have fun hacking with Docker containers.&lt;/p&gt;
&lt;p&gt;Now, I'm going to make a short description of what the Dockerfile makes
and then start the container.&lt;br&gt;
Have fun.&lt;/p&gt;
&lt;p&gt;I used centos as image base for this PoC&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;FROM centos:7
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Typical Maintainer line&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;MAINTAINER Eduardo Gonzalez Gutierrez
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Add jpackage repo which provides Java packages for Linux&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;COPY jpackage-generic.repo /etc/yum.repos.d/jpackage-generic.repo
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Install EPEL and Spacewalk repositories, after install, clean all stored
cache to minimize image size&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;RUN yum install -y http://yum.spacewalkproject.org/2.5/RHEL/7/x86_64/spacewalk-repo-2.5-3.el7.noarch.rpm   
       epel-release &amp;amp;&amp;amp;   
       yum clean all
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Import Keys to allow installation from these repositories&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;RUN&lt;/span&gt; &lt;span class="n"&gt;rpm&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;www&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;jpackage&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;org&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jpackage&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asc&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;   
   &lt;span class="n"&gt;rpm&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;https&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;dl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fedoraproject&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;org&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;pub&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;epel&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;RPM&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;GPG&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;KEY&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;EPEL&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;   
   &lt;span class="n"&gt;rpm&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;yum&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spacewalkproject&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;org&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;RPM&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;GPG&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;KEY&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;spacewalk&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2015&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;   
   &lt;span class="n"&gt;yum&lt;/span&gt; &lt;span class="n"&gt;clean&lt;/span&gt; &lt;span class="nb"&gt;all&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Install spacewalk and supervisord packages&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;RUN yum -y install   
       spacewalk-setup-postgresql   
       spacewalk-postgresql   
       supervisor    
       yum clean all
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Copy the example file used to sync spacewalk database in a later step&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;COPY answerfile.txt /tmp/answerfile.txt
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Open necessary ports&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;EXPOSE 80 443 5222 68 69
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Change to postgres user&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;USER postgres
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Initialize the database&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;RUN /usr/bin/pg_ctl initdb  -D /var/lib/pgsql/data/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Create spacewalk database, user, role and create pltclu language&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;RUN /usr/bin/pg_ctl start -D /var/lib/pgsql/data/  -w -t 300 &amp;amp;&amp;amp;   
    psql -c &amp;#39;CREATE DATABASE spaceschema&amp;#39; &amp;amp;&amp;amp;   
    psql -c &amp;quot;CREATE USER spaceuser WITH PASSWORD &amp;#39;spacepw&amp;#39;&amp;quot; &amp;amp;&amp;amp;   
    psql -c &amp;#39;ALTER ROLE spaceuser SUPERUSER&amp;#39; &amp;amp;&amp;amp;   
    createlang pltclu spaceschema
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Change to root user&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;USER root
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Start the database and execute spacewalk configuration script&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;RUN su -c &amp;quot;/usr/bin/pg_ctl start -D /var/lib/pgsql/data/  -w -t 300&amp;quot; postgres &amp;amp;&amp;amp;   
   su -c &amp;quot;spacewalk-setup --answer-file=/tmp/answerfile.txt --skip-db-diskspace-check --skip-db-install&amp;quot; root ; exit 0
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Copy supervisord configuration&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ADD supervisord.conf /etc/supervisord.d/supervisord.conf
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Use supervisord command to start all services at container launch time&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ENTRYPOINT supervisord -c /etc/supervisord.d/supervisord.conf
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You can check or download the source code at GitHub
&lt;a href="https://github.com/egonzalez90/docker-spacewalk"&gt;https://github.com/egonzalez90/docker-spacewalk&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I uploaded the image to DockerHub, which is auto-build from my GitHub
repository, you can find it with the following command.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[egonzalez@localhost ~]$ docker search spacewalk
INDEX       NAME                                       DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED
docker.io   docker.io/ruo91/spacewalk                  Spacewalk is an open source Linux systems ...   3                    [OK]
docker.io   docker.io/jamesnetherton/spacewalk         Spacewalk running under Docker                  1                    
docker.io   docker.io/coffmant/spacewalk-docker        Spacewalk                                       0                    [OK]
docker.io   docker.io/csabakollar/spacewalk            Spacewalk 2.4 in a CentOS6 container            0                    
docker.io   docker.io/egonzalez90/spacewalk            Spacewalk docker image                          0                    [OK]
docker.io   docker.io/jdostal/spacewalk-clients        Repository containing spacewalk-clients         0                    
docker.io   docker.io/jhutar/spacewalk-client                                                          0                    
docker.io   docker.io/norus/spacewalk-reposync                                                         0                    
docker.io   docker.io/pajinek/spacewalk-client                                                         0                    [OK]
docker.io   docker.io/perfectweb/spacewalk             spacewalk                                       0                    [OK]
docker.io   docker.io/researchiteng/docker-spacewalk   spacewalk is the open source version of Re...   0                    [OK]
docker.io   docker.io/varhoo/spacewalk-proxy                                                           0                    [OK]
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;To start the container use the following command. If you don't have the
image locally, it will download the image from DockerHub&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[egonzalez@localhost ~]$ docker run -d --privileged=True egonzalez90/spacewalk
Unable to find image &amp;#39;egonzalez90/spacewalk:latest&amp;#39; locally
Trying to pull repository docker.io/egonzalez90/spacewalk ... 
latest: Pulling from docker.io/egonzalez90/spacewalk
a3ed95caeb02: Already exists 
da71393503ec: Already exists 
519093688e2c: Pull complete 
97bbffaa9fc9: Pull complete 
63bfb115f62d: Pull complete 
929bbb68aff9: Pull complete 
532bc4af8e1a: Pull complete 
3eb667dda9ee: Pull complete 
275894897aa4: Pull complete 
93bcddf9cedb: Pull complete 
266c3b70754f: Pull complete 
Digest: sha256:a4dd98548f9dbb405fb4c6bb4a2a07b83d5f2bf730f29f71913b72876b1a61ab
Status: Downloaded newer image for docker.io/egonzalez90/spacewalk:latest
ded4a8b7eb1ee61fecc8ddc2eb1b092917a361bc36f7f752b32d76e79501d70a
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now you have the container running, check if all the ports are properly
exposed&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="x"&gt;[egonzalez@localhost ~]$ docker ps --latest --format &amp;#39;table &lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt;&lt;span class="nv"&gt;.ID&lt;/span&gt;&lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;\t&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt;&lt;span class="nv"&gt;.Image&lt;/span&gt;&lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;\t&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt;&lt;span class="nv"&gt;.Ports&lt;/span&gt;&lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&amp;#39;&lt;/span&gt;
&lt;span class="x"&gt;CONTAINER ID        IMAGE                   PORTS&lt;/span&gt;
&lt;span class="x"&gt;ded4a8b7eb1e        egonzalez90/spacewalk   68-69/tcp, 80/tcp, 443/tcp, 5222/tcp&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Get the container IP address in order to enter from a Web Browser&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[egonzalez@localhost ~]$ docker inspect ded4a8b7eb1e | egrep IPAddress
            &amp;quot;SecondaryIPAddresses&amp;quot;: null,
            &amp;quot;IPAddress&amp;quot;: &amp;quot;172.17.0.3&amp;quot;,
                    &amp;quot;IPAddress&amp;quot;: &amp;quot;172.17.0.3&amp;quot;,
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Open A browser and go to the container IP address, if you use HTTP, by
default it will redirect you to HTTPS.&lt;br&gt;
The container uses an auto-signed SSL certificate, you have to add an
exception in the Browser you use to allow connections to Spacewalk.&lt;br&gt;
Once in the Welcome page, create an Organization.&lt;/p&gt;
&lt;p&gt;Now you are in Spacewalk and can play/test some features.  &lt;/p&gt;
&lt;p&gt;&lt;img alt="Selection_003" src="http://egonzalez.org/wp-content/uploads/2016/07/Selection_003-1024x483.png"&gt;&lt;/p&gt;
&lt;p&gt;There is an issue I was not able to fix, so osa-dispatcher and some
other features will not work with this image.&lt;br&gt;
If someone can give me an input to fix the issue it will appreciated.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[egonzalez@localhost ~]$ docker logs ded4a8b7eb1e | egrep FATAL
2016-07-12 18:13:32,220 INFO gave up: osa-dispatcher entered FATAL state, too many start retries too quickly
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Thanks for your time and hopes this image at least serves you to learn
and play with the interface.&lt;/p&gt;
&lt;p&gt;Regards, Eduardo Gonzalez&lt;/p&gt;</content><category term="container"></category><category term="docker"></category><category term="dockerfile"></category><category term="github"></category><category term="image"></category><category term="poc"></category><category term="proofofconcept"></category><category term="redhat"></category><category term="satellite"></category><category term="spacewalk"></category></entry><entry><title>OpenDaylight in a Docker container</title><link href="https://egonzalez90.github.io/opendaylight-in-a-docker-container.html" rel="alternate"></link><published>2016-06-06T18:26:00+02:00</published><updated>2016-06-06T18:26:00+02:00</updated><author><name>egongu90</name></author><id>tag:egonzalez90.github.io,2016-06-06:/opendaylight-in-a-docker-container.html</id><summary type="html">&lt;p&gt;This is a quick guide to start a Docker container with OpenDaylight
running on it.&lt;/p&gt;
&lt;p&gt;Clone OpenDaylight integration repository&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[egonzalez@localhost]$ git clone https://github.com/opendaylight/integration.git
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Move to the directory where CentOS Dockerfile is saved.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[egonzalez@localhost]$ cd integration/packaging/docker/centos/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Build the new image, you …&lt;/p&gt;</summary><content type="html">&lt;p&gt;This is a quick guide to start a Docker container with OpenDaylight
running on it.&lt;/p&gt;
&lt;p&gt;Clone OpenDaylight integration repository&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[egonzalez@localhost]$ git clone https://github.com/opendaylight/integration.git
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Move to the directory where CentOS Dockerfile is saved.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[egonzalez@localhost]$ cd integration/packaging/docker/centos/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Build the new image, you can call it as your DockerHub name(in my case
egonzalez90), so you can push it there later.&lt;br&gt;
If you don't want to create a new image, you can use my image. This
step will download and start the new container:
&lt;code&gt;docker run -d egonzalez90/opendaylight&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[egonzalez@localhost centos]$ docker build -t egonzalez90/opendaylight .

Sending build context to Docker daemon  7.68 kB
Step 1 : FROM centos:7
Trying to pull repository docker.io/library/centos ... 7: Pulling from library/centos
1544084fad81: Pull complete 
df0fc3863fbc: Pull complete 
a3d54b467fad: Pull complete 
a65193109361: Pull complete 
Digest: sha256:a9237ff42b09cc6f610bab60a36df913ef326178a92f3b61631331867178f982
Status: Downloaded newer image for docker.io/centos:7

 ---&amp;gt; a65193109361
Step 2 : MAINTAINER OpenDaylight Project &amp;lt;info@opendaylight.org&amp;gt;
 ---&amp;gt; Running in d3f98f949b11
 ---&amp;gt; 81a1bad2e3a7
Removing intermediate container d3f98f949b11
Step 3 : ADD opendaylight-3-candidate.repo /etc/yum.repos.d/
 ---&amp;gt; 069a9c60878e
Removing intermediate container b9afb18311f3
Step 4 : RUN yum update -y &amp;amp;&amp;amp; yum install -y opendaylight
 ---&amp;gt; Running in 559b3970235d

[[[ PACKAGE INSTALLATION STUFF ]]]

Complete!
 ---&amp;gt; 4003e5874b03
Removing intermediate container 559b3970235d
Step 5 : EXPOSE 162 179 1088 1790 1830 2400 2550 2551 2552 4189 4342 5005 5666 6633 6640 6653 7800 8000 8080 8101 8181 8383 12001
 ---&amp;gt; Running in 7defebe8b7e2
 ---&amp;gt; 9668a559bdac
Removing intermediate container 7defebe8b7e2
Step 6 : WORKDIR /opt/opendaylight
 ---&amp;gt; Running in 9298a116dd14
 ---&amp;gt; 5bf42f56e282
Removing intermediate container 9298a116dd14
Step 7 : CMD ./bin/karaf server
 ---&amp;gt; Running in e0a218941b15
 ---&amp;gt; c1a0db72dbbc
Removing intermediate container e0a218941b15
Successfully built c1a0db72dbbc
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Once the image is built or downloaded, ensure you have it locally&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[egonzalez@localhost]$ docker images | grep opendaylight
egonzalez90/opendaylight                              latest              c1a0db72dbbc        About a minute ago   740.6 MB
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Start a new container in a detached mode.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[egonzalez@localhost]$ docker run -d egonzalez90/opendaylight
ae08898ba6adc30df012513dc6eac54943d9de8c8059e73ade185757fe684c6a
Usage of loopback devices is strongly discouraged for production use. Either use `--storage-opt dm.thinpooldev` or use `--storage-opt dm.no_warn_on_loop_devices=true` to suppress this warning.
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Check if the container is running with:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[egonzalez@localhost]$ docker ps | grep opendaylight 
ae08898ba6ad        egonzalez90/opendaylight   &amp;quot;./bin/karaf server&amp;quot;     14 seconds ago      Up 11 seconds       162/tcp, 179/tcp, 1088/tcp, 1790/tcp, 1830/tcp, 2400/tcp, 2550-2552/tcp, 4189/tcp, 4342/tcp, 5005/tcp, 5666/tcp, 6633/tcp, 6640/tcp, 6653/tcp, 7800/tcp, 8000/tcp, 8080/tcp, 8101/tcp, 8181/tcp, 8383/tcp, 12001/tcp   awesome_khorana
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now, check container information with docker inspect, we search for the
IP address&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[egonzalez@localhost]$ docker inspect  ae08898ba6ad | grep -i IPAddress
        &amp;quot;SecondaryIPAddresses&amp;quot;: null,
        &amp;quot;IPAddress&amp;quot;: &amp;quot;172.17.0.3&amp;quot;,
                &amp;quot;IPAddress&amp;quot;: &amp;quot;172.17.0.3&amp;quot;,
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now you know the container IP address, to login into karaf, first we
need to download and install karaf client tool&lt;br&gt;
Go to the following URL to download the package:
&lt;a href="http://www.apache.org/dyn/closer.lua/karaf/4.0.5/apache-karaf-4.0.5.tar.gz"&gt;http://www.apache.org/dyn/closer.lua/karaf/4.0.5/apache-karaf-4.0.5.tar.gz&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Extract the files and move to the new directory&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[egonzalez@localhost Downloads]$ tar -xzvf apache-karaf-4.0.5.tar.gz 
[egonzalez@localhost Downloads]$ cd apache-karaf-4.0.5/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Execute the client authenticating with the container IP&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;egonzalez&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="nx"&gt;localhost&lt;/span&gt; &lt;span class="nx"&gt;apache&lt;/span&gt;&lt;span class="na"&gt;-karaf&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;4.0.5&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt; &lt;span class="o"&gt;./&lt;/span&gt;&lt;span class="nt"&gt;bin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;client&lt;/span&gt; &lt;span class="nt"&gt;-a&lt;/span&gt; &lt;span class="nt"&gt;8101&lt;/span&gt; &lt;span class="nt"&gt;-h&lt;/span&gt; &lt;span class="nt"&gt;172&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;17&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;3&lt;/span&gt; &lt;span class="nt"&gt;-u&lt;/span&gt; &lt;span class="nt"&gt;karaf&lt;/span&gt; &lt;span class="nt"&gt;-v&lt;/span&gt;
&lt;span class="nt"&gt;client&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;JAVA_HOME&lt;/span&gt; &lt;span class="nt"&gt;not&lt;/span&gt; &lt;span class="nt"&gt;set&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="nt"&gt;results&lt;/span&gt; &lt;span class="nt"&gt;may&lt;/span&gt; &lt;span class="nt"&gt;vary&lt;/span&gt;
&lt;span class="nt"&gt;13&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;main&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;INFO&lt;/span&gt; &lt;span class="nt"&gt;org&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;apache&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;sshd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;common&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;util&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;SecurityUtils&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;BouncyCastle&lt;/span&gt; &lt;span class="nt"&gt;not&lt;/span&gt; &lt;span class="nt"&gt;registered&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;using&lt;/span&gt; &lt;span class="nt"&gt;the&lt;/span&gt; &lt;span class="nt"&gt;default&lt;/span&gt; &lt;span class="nt"&gt;JCE&lt;/span&gt; &lt;span class="nt"&gt;provider&lt;/span&gt;
&lt;span class="nt"&gt;Logging&lt;/span&gt; &lt;span class="nt"&gt;in&lt;/span&gt; &lt;span class="nt"&gt;as&lt;/span&gt; &lt;span class="nt"&gt;karaf&lt;/span&gt;
&lt;span class="nt"&gt;194&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;sshd&lt;/span&gt;&lt;span class="na"&gt;-SshClient&lt;/span&gt;&lt;span class="err"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="nx"&gt;bb4df8&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="nt"&gt;-nio2-thread-1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;INFO&lt;/span&gt; &lt;span class="nt"&gt;org&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;apache&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;sshd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;session&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;ClientSessionImpl&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;Client&lt;/span&gt; &lt;span class="nt"&gt;session&lt;/span&gt; &lt;span class="nt"&gt;created&lt;/span&gt;
&lt;span class="nt"&gt;203&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;main&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;INFO&lt;/span&gt; &lt;span class="nt"&gt;org&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;apache&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;sshd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;session&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;ClientSessionImpl&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;Start&lt;/span&gt; &lt;span class="nt"&gt;flagging&lt;/span&gt; &lt;span class="nt"&gt;packets&lt;/span&gt; &lt;span class="nt"&gt;as&lt;/span&gt; &lt;span class="nt"&gt;pending&lt;/span&gt; &lt;span class="nt"&gt;until&lt;/span&gt; &lt;span class="nt"&gt;key&lt;/span&gt; &lt;span class="nt"&gt;exchange&lt;/span&gt; &lt;span class="nt"&gt;is&lt;/span&gt; &lt;span class="nt"&gt;done&lt;/span&gt;
&lt;span class="nt"&gt;204&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;sshd&lt;/span&gt;&lt;span class="na"&gt;-SshClient&lt;/span&gt;&lt;span class="err"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="nx"&gt;bb4df8&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="nt"&gt;-nio2-thread-1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;INFO&lt;/span&gt; &lt;span class="nt"&gt;org&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;apache&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;sshd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;session&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;ClientSessionImpl&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;Server&lt;/span&gt; &lt;span class="nt"&gt;version&lt;/span&gt; &lt;span class="nt"&gt;string&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;SSH-2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0-SSHD-CORE-0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;12&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;
&lt;span class="nt"&gt;321&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;sshd&lt;/span&gt;&lt;span class="na"&gt;-SshClient&lt;/span&gt;&lt;span class="err"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="nx"&gt;bb4df8&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="nt"&gt;-nio2-thread-3&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;WARN&lt;/span&gt; &lt;span class="nt"&gt;org&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;apache&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;sshd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;keyverifier&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;AcceptAllServerKeyVerifier&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;Server&lt;/span&gt; &lt;span class="nt"&gt;at&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;172&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;17&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;3&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;8101&lt;/span&gt; &lt;span class="nt"&gt;presented&lt;/span&gt; &lt;span class="nt"&gt;unverified&lt;/span&gt; &lt;span class="nt"&gt;DSA&lt;/span&gt; &lt;span class="nt"&gt;key&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;09&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;a0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;45&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;95&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;7a&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;dd&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;94&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;7c&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;6b&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;c3&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;f9&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;c0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;23&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;88&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;1d&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;b0&lt;/span&gt;
&lt;span class="nt"&gt;324&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;sshd&lt;/span&gt;&lt;span class="na"&gt;-SshClient&lt;/span&gt;&lt;span class="err"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="nx"&gt;bb4df8&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="nt"&gt;-nio2-thread-3&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;INFO&lt;/span&gt; &lt;span class="nt"&gt;org&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;apache&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;sshd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;session&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;ClientSessionImpl&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;Dequeing&lt;/span&gt; &lt;span class="nt"&gt;pending&lt;/span&gt; &lt;span class="nt"&gt;packets&lt;/span&gt;
&lt;span class="nt"&gt;327&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;sshd&lt;/span&gt;&lt;span class="na"&gt;-SshClient&lt;/span&gt;&lt;span class="err"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="nx"&gt;bb4df8&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="nt"&gt;-nio2-thread-4&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;INFO&lt;/span&gt; &lt;span class="nt"&gt;org&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;apache&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;sshd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;session&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;ClientUserAuthServiceNew&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;Received&lt;/span&gt; &lt;span class="nt"&gt;SSH_MSG_USERAUTH_FAILURE&lt;/span&gt;
&lt;span class="nt"&gt;338&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;sshd&lt;/span&gt;&lt;span class="na"&gt;-SshClient&lt;/span&gt;&lt;span class="err"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="nx"&gt;bb4df8&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="nt"&gt;-nio2-thread-5&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;INFO&lt;/span&gt; &lt;span class="nt"&gt;org&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;apache&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;sshd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;session&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;ClientUserAuthServiceNew&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;Received&lt;/span&gt; &lt;span class="nt"&gt;SSH_MSG_USERAUTH_FAILURE&lt;/span&gt;
&lt;span class="nt"&gt;341&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;sshd&lt;/span&gt;&lt;span class="na"&gt;-SshClient&lt;/span&gt;&lt;span class="err"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="nx"&gt;bb4df8&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="nt"&gt;-nio2-thread-6&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;INFO&lt;/span&gt; &lt;span class="nt"&gt;org&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;apache&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;sshd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;auth&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;UserAuthKeyboardInteractive&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;Received&lt;/span&gt; &lt;span class="nt"&gt;Password&lt;/span&gt; &lt;span class="nt"&gt;authentication&lt;/span&gt;  &lt;span class="nt"&gt;en-US&lt;/span&gt;
&lt;span class="nt"&gt;344&lt;/span&gt; &lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;sshd&lt;/span&gt;&lt;span class="na"&gt;-SshClient&lt;/span&gt;&lt;span class="err"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="nx"&gt;bb4df8&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="nt"&gt;-nio2-thread-7&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="nt"&gt;INFO&lt;/span&gt; &lt;span class="nt"&gt;org&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;apache&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;sshd&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;session&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;ClientUserAuthServiceNew&lt;/span&gt; &lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;Received&lt;/span&gt; &lt;span class="nt"&gt;SSH_MSG_USERAUTH_SUCCESS&lt;/span&gt;

    &lt;span class="nt"&gt;________&lt;/span&gt;                       &lt;span class="nt"&gt;________&lt;/span&gt;                &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;__&lt;/span&gt;  &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;__&lt;/span&gt;       &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;__&lt;/span&gt;     &lt;span class="nt"&gt;__&lt;/span&gt;       
    &lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="nt"&gt;_____&lt;/span&gt;  &lt;span class="err"&gt;\&lt;/span&gt; &lt;span class="nt"&gt;______&lt;/span&gt;   &lt;span class="nt"&gt;____&lt;/span&gt;   &lt;span class="nt"&gt;____&lt;/span&gt; &lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="nt"&gt;______&lt;/span&gt; &lt;span class="err"&gt;\&lt;/span&gt; &lt;span class="nt"&gt;_____&lt;/span&gt;  &lt;span class="nt"&gt;___&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;__&lt;/span&gt;&lt;span class="o"&gt;.|&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nt"&gt;__&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nt"&gt;____&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nt"&gt;___&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nt"&gt;_&lt;/span&gt;     
     &lt;span class="o"&gt;/&lt;/span&gt;   &lt;span class="o"&gt;|&lt;/span&gt;   &lt;span class="err"&gt;\\&lt;/span&gt;&lt;span class="nt"&gt;____&lt;/span&gt; &lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="nt"&gt;_&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="nt"&gt;__&lt;/span&gt; &lt;span class="err"&gt;\&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;    &lt;span class="err"&gt;\&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="o"&gt;|&lt;/span&gt;  &lt;span class="err"&gt;\\&lt;/span&gt;&lt;span class="nt"&gt;__&lt;/span&gt;  &lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;|/&lt;/span&gt; &lt;span class="nt"&gt;___&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="err"&gt;\&lt;/span&gt; &lt;span class="nt"&gt;__&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="err"&gt;\&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nt"&gt;_&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt;  &lt;span class="nt"&gt;___&lt;/span&gt;&lt;span class="o"&gt;/|&lt;/span&gt;   &lt;span class="o"&gt;|&lt;/span&gt;  &lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;    &lt;span class="err"&gt;`&lt;/span&gt;   &lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="nt"&gt;__&lt;/span&gt; &lt;span class="err"&gt;\\&lt;/span&gt;&lt;span class="nt"&gt;___&lt;/span&gt;  &lt;span class="o"&gt;||&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nt"&gt;_&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;  &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;_&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;  &lt;span class="o"&gt;&amp;gt;&lt;/span&gt;   &lt;span class="nt"&gt;Y&lt;/span&gt;  &lt;span class="err"&gt;\&lt;/span&gt;  &lt;span class="o"&gt;|&lt;/span&gt;      
    &lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="nt"&gt;_______&lt;/span&gt;  &lt;span class="o"&gt;/&lt;/span&gt;   &lt;span class="nt"&gt;__&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="nt"&gt;___&lt;/span&gt;  &lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nt"&gt;___&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;  &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;_______&lt;/span&gt;  &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;____&lt;/span&gt;  &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="nt"&gt;____&lt;/span&gt;&lt;span class="o"&gt;||&lt;/span&gt;&lt;span class="nt"&gt;____&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;__&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="nt"&gt;___&lt;/span&gt;  &lt;span class="o"&gt;/|&lt;/span&gt;&lt;span class="nt"&gt;___&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;  &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;__&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;      
            &lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="o"&gt;/|&lt;/span&gt;&lt;span class="nt"&gt;__&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;        &lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;     &lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;        &lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;     &lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;            &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;_____&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;      &lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;


&lt;span class="nt"&gt;Hit&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class="nt"&gt;for&lt;/span&gt; &lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="nt"&gt;list&lt;/span&gt; &lt;span class="nt"&gt;of&lt;/span&gt; &lt;span class="nt"&gt;available&lt;/span&gt; &lt;span class="nt"&gt;commands&lt;/span&gt;
&lt;span class="nt"&gt;and&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;cmd&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="s1"&gt; --help&amp;#39;&lt;/span&gt; &lt;span class="nt"&gt;for&lt;/span&gt; &lt;span class="nt"&gt;help&lt;/span&gt; &lt;span class="nt"&gt;on&lt;/span&gt; &lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="nt"&gt;specific&lt;/span&gt; &lt;span class="nt"&gt;command&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="nt"&gt;Hit&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class="nt"&gt;or&lt;/span&gt; &lt;span class="nt"&gt;type&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;system:shutdown&amp;#39;&lt;/span&gt; &lt;span class="nt"&gt;or&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;logout&amp;#39;&lt;/span&gt; &lt;span class="nt"&gt;to&lt;/span&gt; &lt;span class="nt"&gt;shutdown&lt;/span&gt; &lt;span class="nt"&gt;OpenDaylight&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Once karaf login succeed, install a few features like DLUX&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;opendaylight-user@root&amp;gt;feature:install odl-restconf odl-l2switch-switch odl-mdsal-apidocs odl-dlux-core
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now you can login at the container IP with admin as username and
password.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;http://172.17.0.3:8181/index.html
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="Selection_001" src="http://egonzalez.org/wp-content/uploads/2016/06/Selection_001.png"&gt;&lt;/p&gt;
&lt;p&gt;Best regards&lt;/p&gt;</content><category term="--configure"></category><category term="container"></category><category term="controller"></category><category term="docker"></category><category term="install"></category><category term="OpenDaylight"></category><category term="sdn"></category></entry><entry><title>Ceph-ansible baremetal deployment</title><link href="https://egonzalez90.github.io/ceph-ansible-baremetal-deployment.html" rel="alternate"></link><published>2016-03-17T22:47:00+01:00</published><updated>2016-03-17T22:47:00+01:00</updated><author><name>egongu90</name></author><id>tag:egonzalez90.github.io,2016-03-17:/ceph-ansible-baremetal-deployment.html</id><summary type="html">&lt;p&gt;How many times you tried to install Ceph? How many fails with no
reason?&lt;br&gt;
All Ceph operator should agree with me when i say that Ceph installer
doesn't really works as expected so far.&lt;br&gt;
Yes, i'm talking about ceph-deploy and the main reason why i'm posting
this guide about deploying …&lt;/p&gt;</summary><content type="html">&lt;p&gt;How many times you tried to install Ceph? How many fails with no
reason?&lt;br&gt;
All Ceph operator should agree with me when i say that Ceph installer
doesn't really works as expected so far.&lt;br&gt;
Yes, i'm talking about ceph-deploy and the main reason why i'm posting
this guide about deploying Ceph with Ansible.&lt;/p&gt;
&lt;p&gt;At this post, i will show how to install a Ceph cluster with Ansible on
baremetal servers.&lt;br&gt;
My configuration is as follows:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;3 x ceph monitors 8GB of RAM each one&lt;/li&gt;
&lt;li&gt;3 x OSD nodes 16GB of RAM and 3x100 GB of Disk&lt;/li&gt;
&lt;li&gt;1 x RadosGateway node 8GB of RAM&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;First, download Ceph-Ansible playbooks&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git clone https://github.com/ceph/ceph-ansible/
Cloning into &amp;#39;ceph-ansible&amp;#39;...
remote: Counting objects: 5764, done.
remote: Compressing objects: 100% (38/38), done.
remote: Total 5764 (delta 7), reused 0 (delta 0), pack-reused 5726
Receiving objects: 100% (5764/5764), 1.12 MiB | 1.06 MiB/s, done.
Resolving deltas: 100% (3465/3465), done.
Checking connectivity... done.
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Move to the newly created folder called ceph-ansible&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cd ceph-ansible/
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Copy sample vars files, we will configure our environment in these
variable files.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cp site.yml.sample site.yml
cp group_vars/all.sample group_vars/all
cp group_vars/mons.sample group_vars/mons
cp group_vars/osds.sample group_vars/osds
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Next step is configure the inventory with our servers, i don't really
like use /etc/ansible/host file, i prefer create a new file per
environment inside playbook's folder.&lt;/p&gt;
&lt;p&gt;Create a file with the following content, use you own IPs to match your
servers on the desired role inside the cluster&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[root@ansible ~]# vi inventory_hosts

[mons]
192.168.1.48
192.168.1.49
192.168.1.52

[osds]
192.168.1.50
192.168.1.53
192.168.1.54

[rgws]
192.168.1.55
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Test connectivity to you servers pinging them through Ansible ping
module&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[root@ansible ~]# ansible -m ping -i inventory_hosts all
192.168.1.48 | success &amp;gt;&amp;gt; {
    &amp;quot;changed&amp;quot;: false,
    &amp;quot;ping&amp;quot;: &amp;quot;pong&amp;quot;
}

192.168.1.50 | success &amp;gt;&amp;gt; {
    &amp;quot;changed&amp;quot;: false,
    &amp;quot;ping&amp;quot;: &amp;quot;pong&amp;quot;
}

192.168.1.55 | success &amp;gt;&amp;gt; {
    &amp;quot;changed&amp;quot;: false,
    &amp;quot;ping&amp;quot;: &amp;quot;pong&amp;quot;
}

192.168.1.53 | success &amp;gt;&amp;gt; {
    &amp;quot;changed&amp;quot;: false,
    &amp;quot;ping&amp;quot;: &amp;quot;pong&amp;quot;
}

192.168.1.49 | success &amp;gt;&amp;gt; {
    &amp;quot;changed&amp;quot;: false,
    &amp;quot;ping&amp;quot;: &amp;quot;pong&amp;quot;
}

192.168.1.54 | success &amp;gt;&amp;gt; {
    &amp;quot;changed&amp;quot;: false,
    &amp;quot;ping&amp;quot;: &amp;quot;pong&amp;quot;
}

192.168.1.52 | success &amp;gt;&amp;gt; {
    &amp;quot;changed&amp;quot;: false,
    &amp;quot;ping&amp;quot;: &amp;quot;pong&amp;quot;
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Edit site.yml file, i will remove/comment mds nodes since i'm not going
to use them.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[root@ansible ~]# vi site.yml

- hosts: mons
  become: True
  roles:
  - ceph-mon

- hosts: agents
  become: True
  roles:
  - ceph-agent

- hosts: osds
  become: True
  roles:
  - ceph-osd

#- hosts: mdss
#  become: True
#  roles:
#  - ceph-mds

- hosts: rgws
  become: True
  roles:
  - ceph-rgw

- hosts: restapis
  become: True
  roles:
  - ceph-restapi
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Edit main variable file, here we are going to configure our environment&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[root@ansible ~]# vi group_vars/all
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Here we configure from where ceph packages are going to be installed,
for now we use upstream code with the stable release Infernalis.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;## Configure package origin
ceph_origin: upstream
ceph_stable: true
ceph_stable_release: infernalis
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Configure interface on which monitor will be listening&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;## Monitor options
monitor_interface: eth2
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Here we configure some OSD options, like journal size and what networks
will be used by public and cluster data replication&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;## OSD options
journal_size: 1024
public_network: 192.168.1.0/24
cluster_network: 192.168.200.0/24
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Edit osds variable file&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[root@ansible ~]# vi group_vars/osds
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;I will use auto discovery option to allow ceph ansible select empy or
not used devices in my servers to create OSDs.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# Declare devices
osd_auto_discovery: True
journal_collocation: True
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Of course you can use other options, i'll highly suggest you to read
variable comments, as they provide valuable information about usage.&lt;br&gt;
We're ready to deploy ceph with ansible with our custom
inventory_hosts file.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[root@ansible ~]# ansible-playbook site.yml -i inventory_hosts
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;After a while, you will have a fully functional ceph cluster.&lt;/p&gt;
&lt;p&gt;Maybe you find some issues or bugs when running the playbooks.&lt;br&gt;
There is a lot of efforts to fix issues on upstream repository. If a
new bug is encountered, please, post a issue right here.&lt;br&gt;
https://github.com/ceph/ceph-ansible/issues&lt;/p&gt;
&lt;p&gt;You can check your cluster status with ceph -s. we can see all OSDs are
up and pgs active/clean.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[root@ceph-mon1 ~]# ceph -s
    cluster 5ff692ab-2150-41a4-8b6d-001a4da21c9c
     health HEALTH_OK
     monmap e1: 3 mons at {ceph-mon1=192.168.200.141:6789/0,ceph-mon2=192.168.200.180:6789/0,ceph-mon3=192.168.200.232:6789/0}
            election epoch 6, quorum 0,1,2 ceph-mon1,ceph-mon2,ceph-mon3
     osdmap e10: 9 osds: 9 up, 9 in
            flags sortbitwise
      pgmap v32: 64 pgs, 1 pools, 0 bytes data, 0 objects
            102256 kB used, 896 GB / 896 GB avail
                  64 active+clean
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We are going to do some tests.&lt;br&gt;
Create a pool&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[root@ceph-mon1 ~]# ceph osd pool create test 128 128
pool &amp;#39;test&amp;#39; created
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Create a file big file&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[root@ceph-mon1 ~]# dd if=/dev/zero of=/tmp/sample.txt bs=2M count=1000
1000+0 records in
1000+0 records out
2097152000 bytes (2.1 GB) copied, 16.7386 s, 125 MB/s
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Upload the file to rados&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[root@ceph-mon1 ~]# rados -p test put sample /tmp/sample.txt
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Check om which placement groups your file is saved&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[root@ceph-mon1 ~]# ceph osd map test sample
osdmap e13 pool &amp;#39;test&amp;#39; (1) object &amp;#39;sample&amp;#39; -&amp;gt; pg 1.bddbf0b9 (1.39) -&amp;gt; up ([1,0], p1) acting ([1,0], p1)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Query the placement group where you file was uploaded, a similar output
will prompts&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;[root@ceph-mon1 ~]# ceph pg 1.39 query
{
    &amp;quot;state&amp;quot;: &amp;quot;active+clean&amp;quot;,
    &amp;quot;snap_trimq&amp;quot;: &amp;quot;[]&amp;quot;,
    &amp;quot;epoch&amp;quot;: 13,
    &amp;quot;up&amp;quot;: [
        1,
        0
    ],
    &amp;quot;acting&amp;quot;: [
        1,
        0
    ],
    &amp;quot;actingbackfill&amp;quot;: [
        &amp;quot;0&amp;quot;,
        &amp;quot;1&amp;quot;
    ],
    &amp;quot;info&amp;quot;: {
        &amp;quot;pgid&amp;quot;: &amp;quot;1.39&amp;quot;,
        &amp;quot;last_update&amp;quot;: &amp;quot;13&amp;#39;500&amp;quot;,
        &amp;quot;last_complete&amp;quot;: &amp;quot;13&amp;#39;500&amp;quot;,
        &amp;quot;log_tail&amp;quot;: &amp;quot;0&amp;#39;0&amp;quot;,
        &amp;quot;last_user_version&amp;quot;: 500,
        &amp;quot;last_backfill&amp;quot;: &amp;quot;MAX&amp;quot;,
        &amp;quot;last_backfill_bitwise&amp;quot;: 0,
        &amp;quot;purged_snaps&amp;quot;: &amp;quot;[]&amp;quot;,
        &amp;quot;history&amp;quot;: {
            &amp;quot;epoch_created&amp;quot;: 11,
            &amp;quot;last_epoch_started&amp;quot;: 12,
            &amp;quot;last_epoch_clean&amp;quot;: 13,
            &amp;quot;last_epoch_split&amp;quot;: 0,
            &amp;quot;last_epoch_marked_full&amp;quot;: 0,
            &amp;quot;same_up_since&amp;quot;: 11,
            &amp;quot;same_interval_since&amp;quot;: 11,
            &amp;quot;same_primary_since&amp;quot;: 11,
            &amp;quot;last_scrub&amp;quot;: &amp;quot;0&amp;#39;0&amp;quot;,
            &amp;quot;last_scrub_stamp&amp;quot;: &amp;quot;2016-03-16 21:13:08.883121&amp;quot;,
            &amp;quot;last_deep_scrub&amp;quot;: &amp;quot;0&amp;#39;0&amp;quot;,
            &amp;quot;last_deep_scrub_stamp&amp;quot;: &amp;quot;2016-03-16 21:13:08.883121&amp;quot;,
            &amp;quot;last_clean_scrub_stamp&amp;quot;: &amp;quot;0.000000&amp;quot;
        },
        &amp;quot;stats&amp;quot;: {
            &amp;quot;version&amp;quot;: &amp;quot;13&amp;#39;500&amp;quot;,
            &amp;quot;reported_seq&amp;quot;: &amp;quot;505&amp;quot;,
            &amp;quot;reported_epoch&amp;quot;: &amp;quot;13&amp;quot;,
            &amp;quot;state&amp;quot;: &amp;quot;active+clean&amp;quot;,
            &amp;quot;last_fresh&amp;quot;: &amp;quot;2016-03-16 21:24:40.930724&amp;quot;,
            &amp;quot;last_change&amp;quot;: &amp;quot;2016-03-16 21:14:09.874086&amp;quot;,
            &amp;quot;last_active&amp;quot;: &amp;quot;2016-03-16 21:24:40.930724&amp;quot;,
            &amp;quot;last_peered&amp;quot;: &amp;quot;2016-03-16 21:24:40.930724&amp;quot;,
            &amp;quot;last_clean&amp;quot;: &amp;quot;2016-03-16 21:24:40.930724&amp;quot;,
            &amp;quot;last_became_active&amp;quot;: &amp;quot;0.000000&amp;quot;,
            &amp;quot;last_became_peered&amp;quot;: &amp;quot;0.000000&amp;quot;,
            &amp;quot;last_unstale&amp;quot;: &amp;quot;2016-03-16 21:24:40.930724&amp;quot;,
            &amp;quot;last_undegraded&amp;quot;: &amp;quot;2016-03-16 21:24:40.930724&amp;quot;,
            &amp;quot;last_fullsized&amp;quot;: &amp;quot;2016-03-16 21:24:40.930724&amp;quot;,
            &amp;quot;mapping_epoch&amp;quot;: 11,
            &amp;quot;log_start&amp;quot;: &amp;quot;0&amp;#39;0&amp;quot;,
            &amp;quot;ondisk_log_start&amp;quot;: &amp;quot;0&amp;#39;0&amp;quot;,
            &amp;quot;created&amp;quot;: 11,
            &amp;quot;last_epoch_clean&amp;quot;: 13,
            &amp;quot;parent&amp;quot;: &amp;quot;0.0&amp;quot;,
            &amp;quot;parent_split_bits&amp;quot;: 0,
            &amp;quot;last_scrub&amp;quot;: &amp;quot;0&amp;#39;0&amp;quot;,
            &amp;quot;last_scrub_stamp&amp;quot;: &amp;quot;2016-03-16 21:13:08.883121&amp;quot;,
            &amp;quot;last_deep_scrub&amp;quot;: &amp;quot;0&amp;#39;0&amp;quot;,
            &amp;quot;last_deep_scrub_stamp&amp;quot;: &amp;quot;2016-03-16 21:13:08.883121&amp;quot;,
            &amp;quot;last_clean_scrub_stamp&amp;quot;: &amp;quot;0.000000&amp;quot;,
            &amp;quot;log_size&amp;quot;: 500,
            &amp;quot;ondisk_log_size&amp;quot;: 500,
            &amp;quot;stats_invalid&amp;quot;: &amp;quot;0&amp;quot;,
            &amp;quot;stat_sum&amp;quot;: {
                &amp;quot;num_bytes&amp;quot;: 2097152000,
                &amp;quot;num_objects&amp;quot;: 1,
                &amp;quot;num_object_clones&amp;quot;: 0,
                &amp;quot;num_object_copies&amp;quot;: 2,
                &amp;quot;num_objects_missing_on_primary&amp;quot;: 0,
                &amp;quot;num_objects_degraded&amp;quot;: 0,
                &amp;quot;num_objects_misplaced&amp;quot;: 0,
                &amp;quot;num_objects_unfound&amp;quot;: 0,
                &amp;quot;num_objects_dirty&amp;quot;: 1,
                &amp;quot;num_whiteouts&amp;quot;: 0,
                &amp;quot;num_read&amp;quot;: 0,
                &amp;quot;num_read_kb&amp;quot;: 0,
                &amp;quot;num_write&amp;quot;: 500,
                &amp;quot;num_write_kb&amp;quot;: 2048000,
                &amp;quot;num_scrub_errors&amp;quot;: 0,
                &amp;quot;num_shallow_scrub_errors&amp;quot;: 0,
                &amp;quot;num_deep_scrub_errors&amp;quot;: 0,
                &amp;quot;num_objects_recovered&amp;quot;: 0,
                &amp;quot;num_bytes_recovered&amp;quot;: 0,
                &amp;quot;num_keys_recovered&amp;quot;: 0,
                &amp;quot;num_objects_omap&amp;quot;: 0,
                &amp;quot;num_objects_hit_set_archive&amp;quot;: 0,
                &amp;quot;num_bytes_hit_set_archive&amp;quot;: 0,
                &amp;quot;num_flush&amp;quot;: 0,
                &amp;quot;num_flush_kb&amp;quot;: 0,
                &amp;quot;num_evict&amp;quot;: 0,
                &amp;quot;num_evict_kb&amp;quot;: 0,
                &amp;quot;num_promote&amp;quot;: 0,
                &amp;quot;num_flush_mode_high&amp;quot;: 0,
                &amp;quot;num_flush_mode_low&amp;quot;: 0,
                &amp;quot;num_evict_mode_some&amp;quot;: 0,
                &amp;quot;num_evict_mode_full&amp;quot;: 0
            },
            &amp;quot;up&amp;quot;: [
                1,
                0
            ],
            &amp;quot;acting&amp;quot;: [
                1,
                0
            ],
            &amp;quot;blocked_by&amp;quot;: [],
            &amp;quot;up_primary&amp;quot;: 1,
            &amp;quot;acting_primary&amp;quot;: 1
        },
        &amp;quot;empty&amp;quot;: 0,
        &amp;quot;dne&amp;quot;: 0,
        &amp;quot;incomplete&amp;quot;: 0,
        &amp;quot;last_epoch_started&amp;quot;: 12,
        &amp;quot;hit_set_history&amp;quot;: {
            &amp;quot;current_last_update&amp;quot;: &amp;quot;0&amp;#39;0&amp;quot;,
            &amp;quot;history&amp;quot;: []
        }
    },
    &amp;quot;peer_info&amp;quot;: [
        {
            &amp;quot;peer&amp;quot;: &amp;quot;0&amp;quot;,
            &amp;quot;pgid&amp;quot;: &amp;quot;1.39&amp;quot;,
            &amp;quot;last_update&amp;quot;: &amp;quot;13&amp;#39;500&amp;quot;,
            &amp;quot;last_complete&amp;quot;: &amp;quot;13&amp;#39;500&amp;quot;,
            &amp;quot;log_tail&amp;quot;: &amp;quot;0&amp;#39;0&amp;quot;,
            &amp;quot;last_user_version&amp;quot;: 0,
            &amp;quot;last_backfill&amp;quot;: &amp;quot;MAX&amp;quot;,
            &amp;quot;last_backfill_bitwise&amp;quot;: 0,
            &amp;quot;purged_snaps&amp;quot;: &amp;quot;[]&amp;quot;,
            &amp;quot;history&amp;quot;: {
                &amp;quot;epoch_created&amp;quot;: 11,
                &amp;quot;last_epoch_started&amp;quot;: 12,
                &amp;quot;last_epoch_clean&amp;quot;: 13,
                &amp;quot;last_epoch_split&amp;quot;: 0,
                &amp;quot;last_epoch_marked_full&amp;quot;: 0,
                &amp;quot;same_up_since&amp;quot;: 0,
                &amp;quot;same_interval_since&amp;quot;: 0,
                &amp;quot;same_primary_since&amp;quot;: 0,
                &amp;quot;last_scrub&amp;quot;: &amp;quot;0&amp;#39;0&amp;quot;,
                &amp;quot;last_scrub_stamp&amp;quot;: &amp;quot;2016-03-16 21:13:08.883121&amp;quot;,
                &amp;quot;last_deep_scrub&amp;quot;: &amp;quot;0&amp;#39;0&amp;quot;,
                &amp;quot;last_deep_scrub_stamp&amp;quot;: &amp;quot;2016-03-16 21:13:08.883121&amp;quot;,
                &amp;quot;last_clean_scrub_stamp&amp;quot;: &amp;quot;0.000000&amp;quot;
            },
            &amp;quot;stats&amp;quot;: {
                &amp;quot;version&amp;quot;: &amp;quot;0&amp;#39;0&amp;quot;,
                &amp;quot;reported_seq&amp;quot;: &amp;quot;0&amp;quot;,
                &amp;quot;reported_epoch&amp;quot;: &amp;quot;0&amp;quot;,
                &amp;quot;state&amp;quot;: &amp;quot;inactive&amp;quot;,
                &amp;quot;last_fresh&amp;quot;: &amp;quot;0.000000&amp;quot;,
                &amp;quot;last_change&amp;quot;: &amp;quot;0.000000&amp;quot;,
                &amp;quot;last_active&amp;quot;: &amp;quot;0.000000&amp;quot;,
                &amp;quot;last_peered&amp;quot;: &amp;quot;0.000000&amp;quot;,
                &amp;quot;last_clean&amp;quot;: &amp;quot;0.000000&amp;quot;,
                &amp;quot;last_became_active&amp;quot;: &amp;quot;0.000000&amp;quot;,
                &amp;quot;last_became_peered&amp;quot;: &amp;quot;0.000000&amp;quot;,
                &amp;quot;last_unstale&amp;quot;: &amp;quot;0.000000&amp;quot;,
                &amp;quot;last_undegraded&amp;quot;: &amp;quot;0.000000&amp;quot;,
                &amp;quot;last_fullsized&amp;quot;: &amp;quot;0.000000&amp;quot;,
                &amp;quot;mapping_epoch&amp;quot;: 0,
                &amp;quot;log_start&amp;quot;: &amp;quot;0&amp;#39;0&amp;quot;,
                &amp;quot;ondisk_log_start&amp;quot;: &amp;quot;0&amp;#39;0&amp;quot;,
                &amp;quot;created&amp;quot;: 0,
                &amp;quot;last_epoch_clean&amp;quot;: 0,
                &amp;quot;parent&amp;quot;: &amp;quot;0.0&amp;quot;,
                &amp;quot;parent_split_bits&amp;quot;: 0,
                &amp;quot;last_scrub&amp;quot;: &amp;quot;0&amp;#39;0&amp;quot;,
                &amp;quot;last_scrub_stamp&amp;quot;: &amp;quot;0.000000&amp;quot;,
                &amp;quot;last_deep_scrub&amp;quot;: &amp;quot;0&amp;#39;0&amp;quot;,
                &amp;quot;last_deep_scrub_stamp&amp;quot;: &amp;quot;0.000000&amp;quot;,
                &amp;quot;last_clean_scrub_stamp&amp;quot;: &amp;quot;0.000000&amp;quot;,
                &amp;quot;log_size&amp;quot;: 0,
                &amp;quot;ondisk_log_size&amp;quot;: 0,
                &amp;quot;stats_invalid&amp;quot;: &amp;quot;0&amp;quot;,
                &amp;quot;stat_sum&amp;quot;: {
                    &amp;quot;num_bytes&amp;quot;: 0,
                    &amp;quot;num_objects&amp;quot;: 0,
                    &amp;quot;num_object_clones&amp;quot;: 0,
                    &amp;quot;num_object_copies&amp;quot;: 0,
                    &amp;quot;num_objects_missing_on_primary&amp;quot;: 0,
                    &amp;quot;num_objects_degraded&amp;quot;: 0,
                    &amp;quot;num_objects_misplaced&amp;quot;: 0,
                    &amp;quot;num_objects_unfound&amp;quot;: 0,
                    &amp;quot;num_objects_dirty&amp;quot;: 0,
                    &amp;quot;num_whiteouts&amp;quot;: 0,
                    &amp;quot;num_read&amp;quot;: 0,
                    &amp;quot;num_read_kb&amp;quot;: 0,
                    &amp;quot;num_write&amp;quot;: 0,
                    &amp;quot;num_write_kb&amp;quot;: 0,
                    &amp;quot;num_scrub_errors&amp;quot;: 0,
                    &amp;quot;num_shallow_scrub_errors&amp;quot;: 0,
                    &amp;quot;num_deep_scrub_errors&amp;quot;: 0,
                    &amp;quot;num_objects_recovered&amp;quot;: 0,
                    &amp;quot;num_bytes_recovered&amp;quot;: 0,
                    &amp;quot;num_keys_recovered&amp;quot;: 0,
                    &amp;quot;num_objects_omap&amp;quot;: 0,
                    &amp;quot;num_objects_hit_set_archive&amp;quot;: 0,
                    &amp;quot;num_bytes_hit_set_archive&amp;quot;: 0,
                    &amp;quot;num_flush&amp;quot;: 0,
                    &amp;quot;num_flush_kb&amp;quot;: 0,
                    &amp;quot;num_evict&amp;quot;: 0,
                    &amp;quot;num_evict_kb&amp;quot;: 0,
                    &amp;quot;num_promote&amp;quot;: 0,
                    &amp;quot;num_flush_mode_high&amp;quot;: 0,
                    &amp;quot;num_flush_mode_low&amp;quot;: 0,
                    &amp;quot;num_evict_mode_some&amp;quot;: 0,
                    &amp;quot;num_evict_mode_full&amp;quot;: 0
                },
                &amp;quot;up&amp;quot;: [],
                &amp;quot;acting&amp;quot;: [],
                &amp;quot;blocked_by&amp;quot;: [],
                &amp;quot;up_primary&amp;quot;: -1,
                &amp;quot;acting_primary&amp;quot;: -1
            },
            &amp;quot;empty&amp;quot;: 0,
            &amp;quot;dne&amp;quot;: 0,
            &amp;quot;incomplete&amp;quot;: 0,
            &amp;quot;last_epoch_started&amp;quot;: 12,
            &amp;quot;hit_set_history&amp;quot;: {
                &amp;quot;current_last_update&amp;quot;: &amp;quot;0&amp;#39;0&amp;quot;,
                &amp;quot;history&amp;quot;: []
            }
        }
    ],
    &amp;quot;recovery_state&amp;quot;: [
        {
            &amp;quot;name&amp;quot;: &amp;quot;Started\/Primary\/Active&amp;quot;,
            &amp;quot;enter_time&amp;quot;: &amp;quot;2016-03-16 21:13:36.769083&amp;quot;,
            &amp;quot;might_have_unfound&amp;quot;: [],
            &amp;quot;recovery_progress&amp;quot;: {
                &amp;quot;backfill_targets&amp;quot;: [],
                &amp;quot;waiting_on_backfill&amp;quot;: [],
                &amp;quot;last_backfill_started&amp;quot;: &amp;quot;MIN&amp;quot;,
                &amp;quot;backfill_info&amp;quot;: {
                    &amp;quot;begin&amp;quot;: &amp;quot;MIN&amp;quot;,
                    &amp;quot;end&amp;quot;: &amp;quot;MIN&amp;quot;,
                    &amp;quot;objects&amp;quot;: []
                },
                &amp;quot;peer_backfill_info&amp;quot;: [],
                &amp;quot;backfills_in_flight&amp;quot;: [],
                &amp;quot;recovering&amp;quot;: [],
                &amp;quot;pg_backend&amp;quot;: {
                    &amp;quot;pull_from_peer&amp;quot;: [],
                    &amp;quot;pushing&amp;quot;: []
                }
            },
            &amp;quot;scrub&amp;quot;: {
                &amp;quot;scrubber.epoch_start&amp;quot;: &amp;quot;0&amp;quot;,
                &amp;quot;scrubber.active&amp;quot;: 0,
                &amp;quot;scrubber.waiting_on&amp;quot;: 0,
                &amp;quot;scrubber.waiting_on_whom&amp;quot;: []
            }
        },
        {
            &amp;quot;name&amp;quot;: &amp;quot;Started&amp;quot;,
            &amp;quot;enter_time&amp;quot;: &amp;quot;2016-03-16 21:13:09.216260&amp;quot;
        }
    ],
    &amp;quot;agent_state&amp;quot;: {}
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;That's all for now.&lt;br&gt;
Regards, Eduardo Gonzalez&lt;/p&gt;</content><category term="ansible"></category><category term="baremetal"></category><category term="cep"></category><category term="deployment"></category></entry><entry><title>Ansible ini_file module, simplifying your DevOps life</title><link href="https://egonzalez90.github.io/ansible-ini_file-module-simplifying-your-devops-life.html" rel="alternate"></link><published>2016-02-24T20:00:00+01:00</published><updated>2016-02-24T20:00:00+01:00</updated><author><name>egongu90</name></author><id>tag:egonzalez90.github.io,2016-02-24:/ansible-ini_file-module-simplifying-your-devops-life.html</id><summary type="html">&lt;p&gt;If you don't read docs, one day you'll realize that your an idiot as i
am|was.&lt;/p&gt;
&lt;p&gt;A few days back, I've realized that i was using wrong all Ansible
modules power since i started with it. What happened?&lt;/p&gt;
&lt;p&gt;Most of the time i use Ansible is related to OpenStack …&lt;/p&gt;</summary><content type="html">&lt;p&gt;If you don't read docs, one day you'll realize that your an idiot as i
am|was.&lt;/p&gt;
&lt;p&gt;A few days back, I've realized that i was using wrong all Ansible
modules power since i started with it. What happened?&lt;/p&gt;
&lt;p&gt;Most of the time i use Ansible is related to OpenStack configuration
jobs. Almost, all OpenStack projects use INI formatted files for their
configuration files.&lt;br&gt;
When i started using Ansible, I searched on Google how to configure any
kind of file with Ansible modules. Almost all blogs/forums that i saw,
talked about lineinfile module. So i used these guidelines on my next
few months, now i realize that i was using in the wrong way Ansible
modules.&lt;/p&gt;
&lt;p&gt;Ansible have a module called ini_file, you change values inside INI
formatted files in a easy way , you don't need to use complicated
regular expressions to change a value in a file.&lt;/p&gt;
&lt;p&gt;Here you have ini_file module usage docs:
&lt;a href="http://docs.ansible.com/ansible/ini_file_module.html"&gt;http://docs.ansible.com/ansible/ini_file_module.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;We are going to change Neutron user password in his dump config file, so
we create a simple task on which we can see how ini_file module can be
used.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;- hosts: localhost
  tasks:
  - name: Change neutron user password
    ini_file:
      dest: ~/neutron.conf
      section: keystone_authtoken
      option: password
      value: 12345
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Once the task has been applied, we can see how the values are applied in
a proper ini style.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;cat neutron.conf
[keystone_authtoken]
password = 12345
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;How many times you need to make a change in an INI formatted
configuration file with Ansible and used lineinfile module?&lt;br&gt;
If the answer is many times, it's OK, you are a dump like me.&lt;/p&gt;
&lt;p&gt;Regards, Eduardo Gonzalez&lt;/p&gt;</content><category term="--configure"></category><category term="ansible"></category><category term="config"></category><category term="file"></category><category term="idiot"></category><category term="ini"></category><category term="ini_file"></category><category term="openstack"></category><category term="style"></category></entry></feed>